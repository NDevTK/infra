<link rel="import" href="../../../bower_components/polymer/polymer.html">

<link rel="import" href="../../redux/redux-mixin.html">
<link rel="import" href="../../mr-comment-content/mr-comment-content.html">

<link rel="import" href="../mr-comments/mr-comments.html">

<link rel="import" href="../mr-edit-metadata/mr-edit-issue.html">
<link rel="import" href="../mr-inline-editor/mr-inline-editor.html">
<link rel="import" href="../shared/mr-flt-styles.html">

<dom-module id="mr-issue-details">
  <template>
    <style include="mr-flt-styles">
      :host {
        font-size: 85%;
        background-color: white;
        padding: 0;
        padding-bottom: 1em;
        display: flex;
        align-items: stretch;
        justify-content: flex-start;
        flex-direction: column;
        z-index: 1;
        margin: 0;
        box-sizing: border-box;
      }
      h3 {
        margin-top: 1em;
      }
      .comments-section{
        box-sizing: border-box;
        padding: 0.25em 8px;
      }
    </style>
    <mr-inline-editor
      id="editDescription"
      heading-level=2
      content="[[_description.content]]"
      title="Feature description"
      edit-text="Edit description"
      placeholder="Feature description"
      on-save="_updateDescriptionHandler"
    >
      <mr-comment-content content="[[_description.content]]"></mr-comment-content>
    </mr-inline-editor>
    <h2 class="medium-heading" hidden$="[[!_comments.length]]">
      Feature discussion / Changelog
    </h2>
    <mr-comments
      heading-level=3
      comments="[[_comments]]"
      comments-shown-count=5
    >
      <h3 id="editIssue" class="medium-heading">Add a comment and make changes</h3>
      <mr-edit-issue
        id="metadataForm"
        owner-name="[[_omitEmptyDisplayName(issue.ownerRef.displayName)]]"
        cc="[[issue.ccRefs]]"
        status="[[issue.statusRef.status]]"
        statuses="[[statuses]]"
        summary="[[issue.summary]]"
        components="[[issue.componentRefs]]"
        field-defs="[[_fieldDefs]]"
        field-values="[[issue.fieldValues]]"
        blocked-on="[[issue.blockedOnIssueRefs]]"
        blocking="[[issue.blockingIssueRefs]]"
        label-names="[[_labelNames]]"
      ></mr-edit-issue>
    </mr-comments>
  </template>
  <script src="./mr-issue-details.js"></script>
<dom-module>
