// Copyright 2020 The Chromium OS Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.

package main

import (
	"golang.org/x/crypto/ssh"
)

// The provided key is copied from
// https://chromium.googlesource.com/chromiumos/chromite/+/master/ssh_keys/testing_rsa
// It's a well known "private" key used widely in Chrome OS testing.
const sshKeyContent = `
-----BEGIN RSA PRIVATE KEY-----
MIIEoAIBAAKCAQEAvsNpFdK5lb0GfKx+FgsrsM/2+aZVFYXHMPdvGtTz63ciRhq0
Jnw7nln1SOcHraSz3/imECBg8NHIKV6rA+B9zbf7pZXEv20x5Ul0vrcPqYWC44PT
tgsgvi8s0KZUZN93YlcjZ+Q7BjQ/tuwGSaLWLqJ7hnHALMJ3dbEM9fKBHQBCrG5H
OaWD2gtXj7jp04M/WUnDDdemq/KMg6E9jcrJOiQ39IuTpas4hLQzVkKAKSrpl6MY
2etHyoNarlWhcOwitArEDwf3WgnctwKstI/MTKB5BTpO2WXUNUv4kXzA+g8/l1al
jIG13vtd9A/IV3KFVx/sLkkjuZ7z2rQXyNKuJwIBIwKCAQA79EWZJPh/hI0CnJyn
16AEXp4T8nKDG2p9GpCiCGnq6u2Dvz/u1pZk97N9T+x4Zva0GvJc1vnlST7objW/
Y8/ET8QeGSCT7x5PYDqiVspoemr3DCyYTKPkADKn+cLAngDzBXGHDTcfNP4U6xfr
Qc5JK8BsFR8kApqSs/zCU4eqBtp2FVvPbgUOv3uUrFnjEuGs9rb1QZ0K6o08L4Cq
N+e2nTysjp78blakZfqlurqTY6iJb0ImU2W3T8sV6w5GP1NT7eicXLO3WdIRB15a
evogPeqtMo8GcO62wU/D4UCvq4GNEjvYOvFmPzXHvhTxsiWv5KEACtleBIEYmWHA
POwrAoGBAOKgNRgxHL7r4bOmpLQcYK7xgA49OpikmrebXCQnZ/kZ3QsLVv1QdNMH
Rx/ex7721g8R0oWslM14otZSMITCDCMWTYVBNM1bqYnUeEu5HagFwxjQ2tLuSs8E
SBzEr96JLfhwuBhDH10sQqn+OQG1yj5acs4Pt3L4wlYwMx0vs1BxAoGBANd9Owro
5ONiJXfKNaNY/cJYuLR+bzGeyp8oxToxgmM4UuA4hhDU7peg4sdoKJ4XjB9cKMCz
ZGU5KHKKxNf95/Z7aywiIJEUE/xPRGNP6tngRunevp2QyvZf4pgvACvk1tl9B3HH
7J5tY/GRkT4sQuZYpx3YnbdP5Y6Kx33BF7QXAoGAVCzghVQR/cVT1QNhvz29gs66
iPIrtQnwUtNOHA6i9h+MnbPBOYRIpidGTaqEtKTTKisw79JjJ78X6TR4a9ML0oSg
c1K71z9NmZgPbJU25qMN80ZCph3+h2f9hwc6AjLz0U5wQ4alP909VRVIX7iM8paf
q59wBiHhyD3J16QAxhsCgYBu0rCmhmcV2rQu+kd4lCq7uJmBZZhFZ5tny9MlPgiK
zIJkr1rkFbyIfqCDzyrU9irOTKc+iCUA25Ek9ujkHC4m/aTU3lnkNjYp/OFXpXF3
XWZMY+0Ak5uUpldG85mwLIvATu3ivpbyZCTFYM5afSm4StmaUiU5tA+oZKEcGily
jwKBgBdFLg+kTm877lcybQ04G1kIRMf5vAXcConzBt8ry9J+2iX1ddlu2K2vMroD
1cP/U/EmvoCXSOGuetaI4UNQwE/rGCtkpvNj5y4twVLh5QufSOl49V0Ut0mwjPXw
HfN/2MoO07vQrjgsFylvrw9A79xItABaqKndlmqlwMZWc9Ne
-----END RSA PRIVATE KEY-----
`

const sshKeyForProxyContent = `
-----BEGIN OPENSSH PRIVATE KEY-----
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
-----END OPENSSH PRIVATE KEY-----
`

var sshSigner, sshSignerForProxy ssh.Signer

func init() {
	var err error
	sshSigner, err = ssh.ParsePrivateKey([]byte(sshKeyContent))
	if err != nil {
		panic(err.Error())
	}
	sshSignerForProxy, err = ssh.ParsePrivateKey([]byte(sshKeyForProxyContent))
	if err != nil {
		panic(err.Error())
	}
}
