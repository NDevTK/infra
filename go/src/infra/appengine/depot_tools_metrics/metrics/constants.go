// Copyright 2019 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.

package metrics

import (
	"regexp"

	"go.chromium.org/luci/common/data/stringset"
)

var (
	pythonVersionRegex = regexp.MustCompile("^\\d\\.\\d{1,2}.\\d{1,2}$")

	gitVersionRegex = regexp.MustCompile("^\\d\\.\\d{1,2}.\\d{1,2}$")

	knownCommands = stringset.NewFromSlice(
		"gclient config",
		"gclient diff",
		"gclient fetch",
		"gclient flatten",
		"gclient getdep",
		"gclient grep",
		"gclient help",
		"gclient metrics",
		"gclient pack",
		"gclient recurse",
		"gclient revert",
		"gclient revinfo",
		"gclient root",
		"gclient runhooks",
		"gclient setdep",
		"gclient status",
		"gclient sync",
		"gclient validate",
		"gclient verify",
		"git cl archive",
		"git cl baseurl",
		"git cl checkout",
		"git cl comments",
		"git cl config",
		"git cl creds-check",
		"git cl dcommit",
		"git cl description",
		"git cl diff",
		"git cl format",
		"git cl help",
		"git cl issue",
		"git cl land",
		"git cl lint",
		"git cl owners",
		"git cl patch",
		"git cl presubmit",
		"git cl set-close",
		"git cl set-commit",
		"git cl split",
		"git cl status",
		"git cl tree",
		"git cl try",
		"git cl try-results",
		"git cl upload",
		"git cl upstream",
		"git cl web",
		"git nav-downstream",
	)

	knownArguments = stringset.NewFromSlice(
		"A",
		"D",
		"H",
		"M",
		"R",
		"a",
		"activate_update",
		"actual",
		"add_comment",
		"all",
		"auto_rebase",
		"b",
		"bot",
		"break_repo_locks",
		"bucket",
		"bug",
		"bypass_hooks",
		"bypass_watchlists",
		"c",
		"cache_dir",
		"cc",
		"clear",
		"clober",
		"cq_dry_run",
		"custom_vars",
		"d",
		"deactivate_update",
		"delete_unversioned_trees",
		"dependencies",
		"deps",
		"deps_file",
		"deps_os",
		"diff",
		"directory",
		"disable_syntax_validation",
		"display",
		"dry_run",
		"email",
		"enable_auto_submit",
		"enable_metrics",
		"f",
		"fast",
		"field",
		"filter",
		"force",
		"full",
		"gclientfile",
		"gerrit",
		"getdep_revisions",
		"hashtags",
		"head",
		"i",
		"ignore",
		"ignore_locks",
		"issue",
		"j",
		"jobs",
		"js",
		"json",
		"json_file",
		"lock_timeout",
		"m",
		"machine_readable",
		"manually_grab_svn_rev",
		"merge",
		"message",
		"message_file",
		"n",
		"name",
		"new_description",
		"newbranch",
		"no_bootstrap",
		"no_branch_color",
		"no_commit",
		"no_history",
		"no_nag_max",
		"no_progress",
		"no_rebase_patch_ref",
		"no_reset_patch_ref",
		"no_squash",
		"nohooks",
		"noprehooks",
		"notags",
		"null",
		"opt_in",
		"opt_out",
		"output_deps",
		"output_deps_files",
		"output_json",
		"p",
		"parallel",
		"patch_ref",
		"pin_all_deps",
		"prepend_dir",
		"presubmit",
		"private",
		"process_all_deps",
		"python",
		"r",
		"r_owners",
		"reject",
		"reset",
		"reverse",
		"reviewers",
		"revision",
		"revisions",
		"s",
		"scm",
		"send_mail",
		"setdep_revisions",
		"shallow",
		"snapshot",
		"spec",
		"squash",
		"t",
		"tbr_owners",
		"tbrs",
		"title",
		"topic",
		"transitive",
		"u",
		"unmanaged",
		"upload",
		"upstream",
		"use_commit_queue",
		"v",
		"validate_syntax",
		"var",
		"vars",
		"verbose",
		"with_branch_heads",
		"with_tags",
	)

	knownProjectURLs = stringset.NewFromSlice(
		"https://chrome-internal.googlesource.com/chrome/ios_internal",
		"https://chrome-internal.googlesource.com/infra/infra_internal",
		"https://chromium.googlesource.com/breakpad/breakpad",
		"https://chromium.googlesource.com/chromium/src",
		"https://chromium.googlesource.com/chromium/tools/depot_tools",
		"https://chromium.googlesource.com/crashpad/crashpad",
		"https://chromium.googlesource.com/external/gyp",
		"https://chromium.googlesource.com/external/naclports",
		"https://chromium.googlesource.com/infra/goma/client",
		"https://chromium.googlesource.com/infra/infra",
		"https://chromium.googlesource.com/native_client/",
		"https://chromium.googlesource.com/syzygy",
		"https://chromium.googlesource.com/v8/v8",
		"https://dart.googlesource.com/sdk",
		"https://pdfium.googlesource.com/pdfium",
		"https://skia.googlesource.com/buildbot",
		"https://skia.googlesource.com/skia",
		"https://webrtc.googlesource.com/src",
	)

	knownOSs = stringset.NewFromSlice(
		"android",
		"fuchsia",
		"ios",
		"linux",
		"mac",
		"win",
	)

	knownArchs = stringset.NewFromSlice(
		"AMD64",
		"arm",
		"arm64",
		"ia32",
		"mips",
		"ppc",
		"s390",
		"x64",
		"x86",
	)

	knownHTTPHosts = stringset.NewFromSlice(
		"chrome-internal-review.googlesource.com",
		"chromium-review.googlesource.com",
		"dart-review.googlesource.com",
		"pdfium-review.googlesource.com",
		"skia-review.googlesource.com",
		"us1-mirror-chromium-review.googlesource.com",
		"us2-mirror-chromium-review.googlesource.com",
		"us3-mirror-chromium-review.googlesource.com",
		"webrtc-review.googlesource.com",
	)

	knownHTTPMethods = stringset.NewFromSlice(
		"DELETE",
		"GET",
		"PATCH",
		"POST",
		"PUT",
	)

	knownHTTPPaths = stringset.NewFromSlice(
		"accounts",
		"changes",
		"changes/abandon",
		"changes/comments",
		"changes/detail",
		"changes/edit",
		"changes/message",
		"changes/restore",
		"changes/reviewers",
		"changes/revisions/commit",
		"changes/revisions/review",
		"changes/submit",
		"projects/branches",
	)

	knownHTTPArguments = stringset.NewFromSlice(
		"ALL_REVISIONS",
		"CURRENT_COMMIT",
		"CURRENT_REVISION",
		"DETAILED_ACCOUNTS",
		"LABELS",
	)

	knownSubCommands = stringset.NewFromSlice(
		"git push",
	)

	knownSubCommandArguments = stringset.NewFromSlice(
		"cc",
		"hashtag",
		"l=Auto-Submit+1",
		"l=Code-Review+1",
		"l=Code-Review+2",
		"l=Commit-Queue+1",
		"l=Commit-Queue+2",
		"label",
		"m",
		"notify=ALL",
		"notify=NONE",
		"private",
		"r",
		"ready",
		"topic",
		"wip",
	)
)
