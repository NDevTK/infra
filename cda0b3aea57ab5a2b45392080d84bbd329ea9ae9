{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "2830e654_6e8fe0d2",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1142534
      },
      "writtenOn": "2022-08-02T18:14:48Z",
      "side": 1,
      "message": "As this is a dangerous change, involve multiple eyes to double check",
      "revId": "cda0b3aea57ab5a2b45392080d84bbd329ea9ae9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7fe5bd9e_70253dd2",
        "filename": "go/src/infra/unifiedfleet/app/controller/dut_test.go",
        "patchSetId": 6
      },
      "lineNbr": 2692,
      "author": {
        "id": 1142534
      },
      "writtenOn": "2022-08-02T21:38:25Z",
      "side": 1,
      "message": "need to test the case that database contains the old format of hwiddata",
      "range": {
        "startLine": 2692,
        "startChar": 2,
        "endLine": 2692,
        "endChar": 58
      },
      "revId": "cda0b3aea57ab5a2b45392080d84bbd329ea9ae9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1029a5f2_2646b3cf",
        "filename": "go/src/infra/unifiedfleet/app/controller/dut_test.go",
        "patchSetId": 6
      },
      "lineNbr": 2692,
      "author": {
        "id": 1429712
      },
      "writtenOn": "2022-08-15T19:27:25Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "7fe5bd9e_70253dd2",
      "range": {
        "startLine": 2692,
        "startChar": 2,
        "endLine": 2692,
        "endChar": 58
      },
      "revId": "cda0b3aea57ab5a2b45392080d84bbd329ea9ae9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2208d4bc_1bf7abaf",
        "filename": "go/src/infra/unifiedfleet/app/controller/hwid.go",
        "patchSetId": 6
      },
      "lineNbr": 30,
      "author": {
        "id": 1333207
      },
      "writtenOn": "2022-08-02T18:54:47Z",
      "side": 1,
      "message": "Is this required?",
      "range": {
        "startLine": 30,
        "startChar": 0,
        "endLine": 30,
        "endChar": 2
      },
      "revId": "cda0b3aea57ab5a2b45392080d84bbd329ea9ae9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "180cc3a0_44a2a6d1",
        "filename": "go/src/infra/unifiedfleet/app/controller/hwid.go",
        "patchSetId": 6
      },
      "lineNbr": 30,
      "author": {
        "id": 1429712
      },
      "writtenOn": "2022-08-02T19:07:22Z",
      "side": 1,
      "message": "The linter keeps adding the line back whenever I delete it...",
      "parentUuid": "2208d4bc_1bf7abaf",
      "range": {
        "startLine": 30,
        "startChar": 0,
        "endLine": 30,
        "endChar": 2
      },
      "revId": "cda0b3aea57ab5a2b45392080d84bbd329ea9ae9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8741ffbc_fecfa817",
        "filename": "go/src/infra/unifiedfleet/app/controller/hwid.go",
        "patchSetId": 6
      },
      "lineNbr": 30,
      "author": {
        "id": 1429712
      },
      "writtenOn": "2022-08-15T19:27:25Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "180cc3a0_44a2a6d1",
      "range": {
        "startLine": 30,
        "startChar": 0,
        "endLine": 30,
        "endChar": 2
      },
      "revId": "cda0b3aea57ab5a2b45392080d84bbd329ea9ae9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "97c3a548_b7e877e0",
        "filename": "go/src/infra/unifiedfleet/app/controller/hwid_test.go",
        "patchSetId": 6
      },
      "lineNbr": 107,
      "author": {
        "id": 1142534
      },
      "writtenOn": "2022-08-02T21:38:25Z",
      "side": 1,
      "message": "need to test the case that database contains the old format of hwiddata",
      "range": {
        "startLine": 107,
        "startChar": 5,
        "endLine": 107,
        "endChar": 22
      },
      "revId": "cda0b3aea57ab5a2b45392080d84bbd329ea9ae9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "43366398_1c198611",
        "filename": "go/src/infra/unifiedfleet/app/controller/hwid_test.go",
        "patchSetId": 6
      },
      "lineNbr": 107,
      "author": {
        "id": 1429712
      },
      "writtenOn": "2022-08-15T19:27:25Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "97c3a548_b7e877e0",
      "range": {
        "startLine": 107,
        "startChar": 5,
        "endLine": 107,
        "endChar": 22
      },
      "revId": "cda0b3aea57ab5a2b45392080d84bbd329ea9ae9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cef1df06_edf680bc",
        "filename": "go/src/infra/unifiedfleet/app/model/configuration/hwid.go",
        "patchSetId": 6
      },
      "lineNbr": 113,
      "author": {
        "id": 1142534
      },
      "writtenOn": "2022-08-02T18:12:27Z",
      "side": 1,
      "message": "did this work?\n\nif the data stored in db is in old format of HwidData, you will get err when calling ent.GetProto()?",
      "range": {
        "startLine": 101,
        "startChar": 0,
        "endLine": 113,
        "endChar": 39
      },
      "revId": "cda0b3aea57ab5a2b45392080d84bbd329ea9ae9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3ab865be_2b2421d5",
        "filename": "go/src/infra/unifiedfleet/app/model/configuration/hwid.go",
        "patchSetId": 6
      },
      "lineNbr": 113,
      "author": {
        "id": 1429712
      },
      "writtenOn": "2022-08-02T19:07:22Z",
      "side": 1,
      "message": "It will not. That\u0027s why there\u0027s the block in line 115. The only way to know is to check if data.DutLabel is correctly formed.",
      "parentUuid": "cef1df06_edf680bc",
      "range": {
        "startLine": 101,
        "startChar": 0,
        "endLine": 113,
        "endChar": 39
      },
      "revId": "cda0b3aea57ab5a2b45392080d84bbd329ea9ae9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "700ef9e1_9586548f",
        "filename": "go/src/infra/unifiedfleet/app/model/configuration/hwid.go",
        "patchSetId": 6
      },
      "lineNbr": 113,
      "author": {
        "id": 1142534
      },
      "writtenOn": "2022-08-02T19:35:39Z",
      "side": 1,
      "message": "sorry I didn\u0027t follow. if there\u0027s error, you will return and never hit line 119?",
      "parentUuid": "3ab865be_2b2421d5",
      "range": {
        "startLine": 101,
        "startChar": 0,
        "endLine": 113,
        "endChar": 39
      },
      "revId": "cda0b3aea57ab5a2b45392080d84bbd329ea9ae9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8f2cb9e6_cbd054f7",
        "filename": "go/src/infra/unifiedfleet/app/model/configuration/hwid.go",
        "patchSetId": 6
      },
      "lineNbr": 113,
      "author": {
        "id": 1429712
      },
      "writtenOn": "2022-08-02T20:51:22Z",
      "side": 1,
      "message": "I think I misinterpreted the original question. If `ent.GetProto()` gives error, it will be a different problem. Not because the data is in old format. Then it will just return error.\n\n`ent.GetProto()` will not error if data is in old format. But if it is in old format, `hwidData.GetDutLabel()` will be nil. Then the block from 115-128 will execute.",
      "parentUuid": "700ef9e1_9586548f",
      "range": {
        "startLine": 101,
        "startChar": 0,
        "endLine": 113,
        "endChar": 39
      },
      "revId": "cda0b3aea57ab5a2b45392080d84bbd329ea9ae9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e7a1e8d7_27beec8f",
        "filename": "go/src/infra/unifiedfleet/app/model/configuration/hwid.go",
        "patchSetId": 6
      },
      "lineNbr": 113,
      "author": {
        "id": 1142534
      },
      "writtenOn": "2022-08-02T21:32:16Z",
      "side": 1,
      "message": "you can marshal the old data to new proto? I need to verify locally as I thought it will fail",
      "parentUuid": "8f2cb9e6_cbd054f7",
      "range": {
        "startLine": 101,
        "startChar": 0,
        "endLine": 113,
        "endChar": 39
      },
      "revId": "cda0b3aea57ab5a2b45392080d84bbd329ea9ae9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0b063eeb_925b344d",
        "filename": "go/src/infra/unifiedfleet/app/model/configuration/hwid.go",
        "patchSetId": 6
      },
      "lineNbr": 113,
      "author": {
        "id": 1142534
      },
      "writtenOn": "2022-08-02T21:34:52Z",
      "side": 1,
      "message": "maybe it\u0027s because the old one and new one are pretty similar and have similar fields. will check the unittest later to see if it\u0027s the case",
      "parentUuid": "e7a1e8d7_27beec8f",
      "range": {
        "startLine": 101,
        "startChar": 0,
        "endLine": 113,
        "endChar": 39
      },
      "revId": "cda0b3aea57ab5a2b45392080d84bbd329ea9ae9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1eb29429_befceffb",
        "filename": "go/src/infra/unifiedfleet/app/model/configuration/hwid.go",
        "patchSetId": 6
      },
      "lineNbr": 113,
      "author": {
        "id": 1429712
      },
      "writtenOn": "2022-08-15T19:27:25Z",
      "side": 1,
      "message": "Go doesn\u0027t prevent it. It will try a best guess match. And the protos are quite similar so it ends up giving some fields. But the `DutLabel` field remains empty if it is not the right proto format.",
      "parentUuid": "0b063eeb_925b344d",
      "range": {
        "startLine": 101,
        "startChar": 0,
        "endLine": 113,
        "endChar": 39
      },
      "revId": "cda0b3aea57ab5a2b45392080d84bbd329ea9ae9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4afb568f_4362da38",
        "filename": "go/src/infra/unifiedfleet/app/model/configuration/hwid.go",
        "patchSetId": 6
      },
      "lineNbr": 113,
      "author": {
        "id": 1142534
      },
      "writtenOn": "2022-08-22T18:21:53Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "1eb29429_befceffb",
      "range": {
        "startLine": 101,
        "startChar": 0,
        "endLine": 113,
        "endChar": 39
      },
      "revId": "cda0b3aea57ab5a2b45392080d84bbd329ea9ae9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "91d797ba_58f8282d",
        "filename": "go/src/infra/unifiedfleet/app/model/configuration/hwid_test.go",
        "patchSetId": 6
      },
      "lineNbr": 75,
      "author": {
        "id": 1142534
      },
      "writtenOn": "2022-08-02T21:38:25Z",
      "side": 1,
      "message": "need to test:\n\ndata contains old format, you try to update new one. \ndata contains new format, you try to update old one (in case for DUTs some cases work, some cases not)\ndata contains new format, you try to update new one.",
      "range": {
        "startLine": 75,
        "startChar": 5,
        "endLine": 75,
        "endChar": 23
      },
      "revId": "cda0b3aea57ab5a2b45392080d84bbd329ea9ae9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "fc38a890_e3488065",
        "filename": "go/src/infra/unifiedfleet/app/model/configuration/hwid_test.go",
        "patchSetId": 6
      },
      "lineNbr": 75,
      "author": {
        "id": 1429712
      },
      "writtenOn": "2022-08-15T19:27:25Z",
      "side": 1,
      "message": "It\u0027s not possible to update from new to old. The method `UpdateHwidData` takes in only the new `HwidData` format.\n\nOthers are covered.",
      "parentUuid": "91d797ba_58f8282d",
      "range": {
        "startLine": 75,
        "startChar": 5,
        "endLine": 75,
        "endChar": 23
      },
      "revId": "cda0b3aea57ab5a2b45392080d84bbd329ea9ae9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1dab2d4b_8423adc1",
        "filename": "go/src/infra/unifiedfleet/app/model/configuration/hwid_test.go",
        "patchSetId": 6
      },
      "lineNbr": 75,
      "author": {
        "id": 1142534
      },
      "writtenOn": "2022-08-16T04:26:27Z",
      "side": 1,
      "message": "just use this as an example:\n\nthis CL may be reverted as sometime the new data cannot be written in/read, after it\u0027s reverted, datastore already contain some new data, but UpdateHwidData is taking old format. In this case, we still need to make sure new-to-old is working.",
      "parentUuid": "fc38a890_e3488065",
      "range": {
        "startLine": 75,
        "startChar": 5,
        "endLine": 75,
        "endChar": 23
      },
      "revId": "cda0b3aea57ab5a2b45392080d84bbd329ea9ae9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b7c8aa6d_b656157a",
        "filename": "go/src/infra/unifiedfleet/app/model/configuration/hwid_test.go",
        "patchSetId": 6
      },
      "lineNbr": 75,
      "author": {
        "id": 1429712
      },
      "writtenOn": "2022-08-16T21:57:01Z",
      "side": 1,
      "message": "What I meant is we are changing the `UpdateHwidData` method signature so it can no longer take the old format. I changed `fakeUpdateLegacyHwidData` to be `UpdateLegacyHwidData` and that is the old implementation. Also added tests for `UpdateLegacyHwidData`.",
      "parentUuid": "1dab2d4b_8423adc1",
      "range": {
        "startLine": 75,
        "startChar": 5,
        "endLine": 75,
        "endChar": 23
      },
      "revId": "cda0b3aea57ab5a2b45392080d84bbd329ea9ae9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fbfb1ca4_4d181c59",
        "filename": "go/src/infra/unifiedfleet/app/model/configuration/hwid_test.go",
        "patchSetId": 6
      },
      "lineNbr": 75,
      "author": {
        "id": 1142534
      },
      "writtenOn": "2022-08-22T17:54:26Z",
      "side": 1,
      "message": "hmm, I mean after reverting this CL, UpdateHwidData may take old format. Not saying that now it\u0027s taking old format. If everything goes smoothly, then yes, this case will never happen. I\u0027m considering the case that this CL is reverted and whether UFS can successfully run at that time after this CL is merged then reverted.",
      "parentUuid": "b7c8aa6d_b656157a",
      "range": {
        "startLine": 75,
        "startChar": 5,
        "endLine": 75,
        "endChar": 23
      },
      "revId": "cda0b3aea57ab5a2b45392080d84bbd329ea9ae9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d78aba4a_f0504677",
        "filename": "go/src/infra/unifiedfleet/app/model/configuration/hwid_test.go",
        "patchSetId": 6
      },
      "lineNbr": 75,
      "author": {
        "id": 1429712
      },
      "writtenOn": "2022-08-22T22:57:12Z",
      "side": 1,
      "message": "I think the revert case is covered in the tests now? When we revert, `UpdateHwidData` will revert to use the implementation in `UpdateLegacyHwidData`. But the function name will be `UpdateHwidData`. Not sure if I am missing something else.",
      "parentUuid": "fbfb1ca4_4d181c59",
      "range": {
        "startLine": 75,
        "startChar": 5,
        "endLine": 75,
        "endChar": 23
      },
      "revId": "cda0b3aea57ab5a2b45392080d84bbd329ea9ae9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d060ff83_11fc62fb",
        "filename": "go/src/infra/unifiedfleet/app/model/configuration/hwid_test.go",
        "patchSetId": 6
      },
      "lineNbr": 234,
      "author": {
        "id": 1526722
      },
      "writtenOn": "2022-08-02T21:49:17Z",
      "side": 1,
      "message": "Can you add tests which parses the entities(one with DutLabel and another with HwidData) directly, without the update/get calls to the database so we can test exactly on the input.",
      "revId": "cda0b3aea57ab5a2b45392080d84bbd329ea9ae9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "242be4d8_43eb1b91",
        "filename": "go/src/infra/unifiedfleet/app/model/configuration/hwid_test.go",
        "patchSetId": 6
      },
      "lineNbr": 234,
      "author": {
        "id": 1429712
      },
      "writtenOn": "2022-08-15T19:27:25Z",
      "side": 1,
      "message": "I think the tests in `TestUpdateHwidData` should cover these. I only use `GetProto()` there.",
      "parentUuid": "d060ff83_11fc62fb",
      "revId": "cda0b3aea57ab5a2b45392080d84bbd329ea9ae9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}