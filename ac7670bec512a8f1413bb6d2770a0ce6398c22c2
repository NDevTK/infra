{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "da33537b_343342a8",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1393275
      },
      "writtenOn": "2021-05-10T01:50:29Z",
      "side": 1,
      "message": "Can we split it to:\n1) refactor of harness.go (extract logic to new files)\n2) introduce DUTHarness structure\n3) introduce SchedulingUnit\n4) introduce logic for multi-units\n\nSorry the code have too many changes and they overlap. \n\nAdded comments/questions. ",
      "revId": "ac7670bec512a8f1413bb6d2770a0ce6398c22c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "032c4e0c_85477822",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1307525
      },
      "writtenOn": "2021-05-10T03:59:32Z",
      "side": 1,
      "message": "Given we\u0027re changing the main logic instead of just adding a new feature, it\u0027s hard to split the CL and still make each CLs in a non-broken state.\n\nI can try to extract scheduling unit part, but that probably won\u0027t affect size of the CL much.\n\nAnother benefit is easier to revert if something breaks, given that we\u0027re changing the main logic here.",
      "parentUuid": "da33537b_343342a8",
      "revId": "ac7670bec512a8f1413bb6d2770a0ce6398c22c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cd3b070a_31520b14",
        "filename": "go/src/infra/cmd/skylab_swarming_worker/internal/swmbot/harness/botinfo/botinfo.go",
        "patchSetId": 2
      },
      "lineNbr": 52,
      "author": {
        "id": 1393275
      },
      "writtenOn": "2021-05-10T01:50:29Z",
      "side": 1,
      "message": "I think we can drop it based on crbug.com/994404, then we do not need introduce dutID here?",
      "range": {
        "startLine": 48,
        "startChar": 1,
        "endLine": 52,
        "endChar": 2
      },
      "revId": "ac7670bec512a8f1413bb6d2770a0ce6398c22c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b4d8703e_e5d9d8a2",
        "filename": "go/src/infra/cmd/skylab_swarming_worker/internal/swmbot/harness/botinfo/botinfo.go",
        "patchSetId": 2
      },
      "lineNbr": 52,
      "author": {
        "id": 1307525
      },
      "writtenOn": "2021-05-10T03:59:32Z",
      "side": 1,
      "message": "Will do that in a separate CL.",
      "parentUuid": "cd3b070a_31520b14",
      "range": {
        "startLine": 48,
        "startChar": 1,
        "endLine": 52,
        "endChar": 2
      },
      "revId": "ac7670bec512a8f1413bb6d2770a0ce6398c22c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d5df598d_62a0d7f9",
        "filename": "go/src/infra/cmd/skylab_swarming_worker/internal/swmbot/harness/botinfo/botinfo.go",
        "patchSetId": 2
      },
      "lineNbr": 52,
      "author": {
        "id": 1393275
      },
      "writtenOn": "2021-05-10T18:22:31Z",
      "side": 1,
      "message": "I wanted go say, if we do before this CL then we do not need introduce dutID",
      "parentUuid": "b4d8703e_e5d9d8a2",
      "range": {
        "startLine": 48,
        "startChar": 1,
        "endLine": 52,
        "endChar": 2
      },
      "revId": "ac7670bec512a8f1413bb6d2770a0ce6398c22c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ccf92652_150b3772",
        "filename": "go/src/infra/cmd/skylab_swarming_worker/internal/swmbot/harness/botinfo/botinfo.go",
        "patchSetId": 2
      },
      "lineNbr": 52,
      "author": {
        "id": 1307525
      },
      "writtenOn": "2021-05-10T20:31:36Z",
      "side": 1,
      "message": "I see, but given both changes(\"support SU in ssw\" and \"stop write to id based file\") may cause a situation need revert, we may want to make them into two CLs.",
      "parentUuid": "d5df598d_62a0d7f9",
      "range": {
        "startLine": 48,
        "startChar": 1,
        "endLine": 52,
        "endChar": 2
      },
      "revId": "ac7670bec512a8f1413bb6d2770a0ce6398c22c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d4b6d5b7_6b62e8a6",
        "filename": "go/src/infra/cmd/skylab_swarming_worker/internal/swmbot/harness/dutinfo/dutinfo.go",
        "patchSetId": 2
      },
      "lineNbr": 118,
      "author": {
        "id": 1393275
      },
      "writtenOn": "2021-05-10T01:50:29Z",
      "side": 1,
      "message": "What is the cases when we load data based on DUTID (i think that is asset-tag)?",
      "revId": "ac7670bec512a8f1413bb6d2770a0ce6398c22c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c85737fd_593f669e",
        "filename": "go/src/infra/cmd/skylab_swarming_worker/internal/swmbot/harness/dutinfo/dutinfo.go",
        "patchSetId": 2
      },
      "lineNbr": 118,
      "author": {
        "id": 1307525
      },
      "writtenOn": "2021-05-10T03:59:32Z",
      "side": 1,
      "message": "All non multi-DUTs use case will load DUT data from UFS based on DUTID, this is also how existing workflow works.",
      "parentUuid": "d4b6d5b7_6b62e8a6",
      "revId": "ac7670bec512a8f1413bb6d2770a0ce6398c22c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "68b1118b_65dc366c",
        "filename": "go/src/infra/cmd/skylab_swarming_worker/internal/swmbot/harness/dutinfo/dutinfo.go",
        "patchSetId": 2
      },
      "lineNbr": 118,
      "author": {
        "id": 1393275
      },
      "writtenOn": "2021-05-10T18:22:31Z",
      "side": 1,
      "message": "I thought that for all cases we will have RequestHook and the logic will be common. Can we do that?",
      "parentUuid": "c85737fd_593f669e",
      "revId": "ac7670bec512a8f1413bb6d2770a0ce6398c22c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1cd30ee7_10016292",
        "filename": "go/src/infra/cmd/skylab_swarming_worker/internal/swmbot/harness/dutinfo/dutinfo.go",
        "patchSetId": 2
      },
      "lineNbr": 118,
      "author": {
        "id": 1307525
      },
      "writtenOn": "2021-05-10T20:31:36Z",
      "side": 1,
      "message": "Ah yea, wasn\u0027t realized I can feed both ChromeosDeviceId and Hostname in one request, thanks!",
      "parentUuid": "68b1118b_65dc366c",
      "revId": "ac7670bec512a8f1413bb6d2770a0ce6398c22c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5ee7a1ea_2bb881b7",
        "filename": "go/src/infra/cmd/skylab_swarming_worker/internal/swmbot/harness/schedulingunit/schedulingunit.go",
        "patchSetId": 2
      },
      "lineNbr": 21,
      "author": {
        "id": 1393275
      },
      "writtenOn": "2021-05-10T01:50:29Z",
      "side": 1,
      "message": "please add documentation",
      "revId": "ac7670bec512a8f1413bb6d2770a0ce6398c22c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "17479555_5731ff74",
        "filename": "go/src/infra/cmd/skylab_swarming_worker/internal/swmbot/harness/schedulingunit/schedulingunit.go",
        "patchSetId": 2
      },
      "lineNbr": 21,
      "author": {
        "id": 1307525
      },
      "writtenOn": "2021-05-10T03:59:32Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "5ee7a1ea_2bb881b7",
      "revId": "ac7670bec512a8f1413bb6d2770a0ce6398c22c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5106e7da_d67778f0",
        "filename": "go/src/infra/cmd/skylab_swarming_worker/internal/swmbot/harness/schedulingunit/schedulingunit.go",
        "patchSetId": 2
      },
      "lineNbr": 29,
      "author": {
        "id": 1393275
      },
      "writtenOn": "2021-05-10T01:50:29Z",
      "side": 1,
      "message": "What do we expect for cases when name is not name and just DUT-name?",
      "revId": "ac7670bec512a8f1413bb6d2770a0ce6398c22c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "07465a29_b1ef30d4",
        "filename": "go/src/infra/cmd/skylab_swarming_worker/internal/swmbot/harness/schedulingunit/schedulingunit.go",
        "patchSetId": 2
      },
      "lineNbr": 29,
      "author": {
        "id": 1307525
      },
      "writtenOn": "2021-05-10T03:59:32Z",
      "side": 1,
      "message": "Both dut_id and dut_name dimension in swarming are referred from name field of SchedulingUnit.",
      "parentUuid": "5106e7da_d67778f0",
      "revId": "ac7670bec512a8f1413bb6d2770a0ce6398c22c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b90ce6b6_8168f5ec",
        "filename": "go/src/infra/cmd/skylab_swarming_worker/internal/swmbot/harness/schedulingunit/schedulingunit.go",
        "patchSetId": 2
      },
      "lineNbr": 29,
      "author": {
        "id": 1393275
      },
      "writtenOn": "2021-05-10T18:22:31Z",
      "side": 1,
      "message": "Sorry, i was not clear.\n\nIf setup is not multi-duts then this call will rerun error like not. found or we expect that response will contain name of single device in the setup?",
      "parentUuid": "07465a29_b1ef30d4",
      "revId": "ac7670bec512a8f1413bb6d2770a0ce6398c22c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9e6c7092_b57e2d28",
        "filename": "go/src/infra/cmd/skylab_swarming_worker/internal/swmbot/harness/schedulingunit/schedulingunit.go",
        "patchSetId": 2
      },
      "lineNbr": 29,
      "author": {
        "id": 1307525
      },
      "writtenOn": "2021-05-10T20:31:36Z",
      "side": 1,
      "message": "Non multi-DUTs setup won\u0027t reach this call, in harness.go the logic is only call GetSchedulingUnitFromUFS if IsSchedulingUnit is true in Info.",
      "parentUuid": "b90ce6b6_8168f5ec",
      "revId": "ac7670bec512a8f1413bb6d2770a0ce6398c22c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "df7bf9cb_ddd9ee0c",
        "filename": "go/src/infra/cmd/skylab_swarming_worker/internal/swmbot/info.go",
        "patchSetId": 2
      },
      "lineNbr": 43,
      "author": {
        "id": 1393275
      },
      "writtenOn": "2021-05-10T01:50:29Z",
      "side": 1,
      "message": "does SKYLAB_DUT_ID change the meaning now?",
      "revId": "ac7670bec512a8f1413bb6d2770a0ce6398c22c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a816b47c_b3fc1332",
        "filename": "go/src/infra/cmd/skylab_swarming_worker/internal/swmbot/info.go",
        "patchSetId": 2
      },
      "lineNbr": 43,
      "author": {
        "id": 1307525
      },
      "writtenOn": "2021-05-10T03:59:32Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "df7bf9cb_ddd9ee0c",
      "revId": "ac7670bec512a8f1413bb6d2770a0ce6398c22c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "50574e2a_77265f00",
        "filename": "go/src/infra/cmd/skylab_swarming_worker/internal/swmbot/info.go",
        "patchSetId": 2
      },
      "lineNbr": 44,
      "author": {
        "id": 1393275
      },
      "writtenOn": "2021-05-10T01:50:29Z",
      "side": 1,
      "message": "please add description for FLEET_SCHEDULING_UNIT",
      "revId": "ac7670bec512a8f1413bb6d2770a0ce6398c22c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8ffe7d41_9cba719d",
        "filename": "go/src/infra/cmd/skylab_swarming_worker/internal/swmbot/info.go",
        "patchSetId": 2
      },
      "lineNbr": 44,
      "author": {
        "id": 1307525
      },
      "writtenOn": "2021-05-10T03:59:32Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "50574e2a_77265f00",
      "revId": "ac7670bec512a8f1413bb6d2770a0ce6398c22c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "48d0f596_2200c076",
        "filename": "go/src/infra/cmd/skylab_swarming_worker/internal/swmbot/info.go",
        "patchSetId": 2
      },
      "lineNbr": 60,
      "author": {
        "id": 1393275
      },
      "writtenOn": "2021-05-10T01:50:29Z",
      "side": 1,
      "message": "A few questions:\n1) how we set it?\n2) If I understand it right then the value can be `True` or `False` - if yes then maybe we need set name UseSchedulingUnit and add logic to convert it once to the bool instead check it everywhere?",
      "revId": "ac7670bec512a8f1413bb6d2770a0ce6398c22c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7fcd5262_911d3d00",
        "filename": "go/src/infra/cmd/skylab_swarming_worker/internal/swmbot/info.go",
        "patchSetId": 2
      },
      "lineNbr": 60,
      "author": {
        "id": 1307525
      },
      "writtenOn": "2021-05-10T03:59:32Z",
      "side": 1,
      "message": "(1) We\u0027ll set it in bot script(skylab.py) based on \"label-multiduts\" dimension.\n\n(2) Currently the value can be True of \"\"(empty string) as regular DUT doesn\u0027t have \"label-multiduts\" dimension. Added a logic to convert Info.IsSchedulingUnit to bool.",
      "parentUuid": "48d0f596_2200c076",
      "revId": "ac7670bec512a8f1413bb6d2770a0ce6398c22c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cc183446_3d22b86e",
        "filename": "go/src/infra/cmd/skylab_swarming_worker/internal/swmbot/info.go",
        "patchSetId": 2
      },
      "lineNbr": 60,
      "author": {
        "id": 1393275
      },
      "writtenOn": "2021-05-10T18:22:31Z",
      "side": 1,
      "message": "Acl. \n\n2) My first expectation was that we will get name of the unit and it will be always for multi-duts and not as single dut still scheduling-unit with 1 DUT.",
      "parentUuid": "7fcd5262_911d3d00",
      "revId": "ac7670bec512a8f1413bb6d2770a0ce6398c22c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c82b8785_f94ca8b7",
        "filename": "go/src/infra/cmd/skylab_swarming_worker/internal/swmbot/info.go",
        "patchSetId": 2
      },
      "lineNbr": 60,
      "author": {
        "id": 1307525
      },
      "writtenOn": "2021-05-10T20:31:36Z",
      "side": 1,
      "message": "Right, the single DUT bot will still remains same as before, it will not behind a scheduling unit. So basically we\u0027ll have `SKYLAB_DUT_ID` in ENV for all bots and `FLEET_SCHEDULING_UNIT` in ENV for scheduling unit, where `SKYLAB_DUT_ID` is the dut_id dimension from swarming, and dut_id dimension can be:\n    1. ID field for DeviceUnderTest, so we can use it to get DUT data from UFS in single DUT bot case.\n    2. name field for SchedulingUnit, so we can use it to get SU data from UFS in multi-DUTs bot case.",
      "parentUuid": "cc183446_3d22b86e",
      "revId": "ac7670bec512a8f1413bb6d2770a0ce6398c22c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8c27c0e0_e8780897",
        "filename": "go/src/infra/cmd/skylab_swarming_worker/internal/swmbot/info.go",
        "patchSetId": 2
      },
      "lineNbr": 60,
      "author": {
        "id": 1393275
      },
      "writtenOn": "2021-05-10T20:40:22Z",
      "side": 1,
      "message": "That is my point that in any case any DUT which is presenting in swarming is scheduling unit which mean FLEET_SCHEDULING_UNIT has to tell True for all setups.\n\nmaybe chat will be faster?",
      "parentUuid": "c82b8785_f94ca8b7",
      "revId": "ac7670bec512a8f1413bb6d2770a0ce6398c22c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "75b5ad96_4841f120",
        "filename": "go/src/infra/cmd/skylab_swarming_worker/internal/swmbot/info.go",
        "patchSetId": 2
      },
      "lineNbr": 60,
      "author": {
        "id": 1307525
      },
      "writtenOn": "2021-05-11T02:01:23Z",
      "side": 1,
      "message": "Synced offline with Otabek.",
      "parentUuid": "8c27c0e0_e8780897",
      "revId": "ac7670bec512a8f1413bb6d2770a0ce6398c22c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}