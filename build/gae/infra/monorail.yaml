name: infra/monorail
extends: ../base.yaml

contextdir: ../../../appengine/monorail

build:
  - run: ['make', 'build_frontend']
    cwd: ${contextdir}
    outputs:
      - ${contextdir}/static/dist
      - ${contextdir}/templates/webpack-out

  # This directory is in .gitignore and excluded by default. This statement
  # copies it into the output anyway, skipping some files.
  - copy: '${inputsdir}/lib'
    dest: '${contextdir}/lib'
    ignore: ['*.pyc', '*.pyo']
