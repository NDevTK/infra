{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "7c055fbb_e3557521",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1002539
      },
      "writtenOn": "2023-03-23T00:03:13Z",
      "side": 1,
      "message": "If it just a periodic job, have you considered running it as a builder itself? It can still be written in Go. Maintaining a GAE app using all production guidelines is non-trivial.\n\nWill it serve any API itself?",
      "revId": "4988d6b849e65fcb24e806e410eefbd13826577d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "27bca13f_d28a300b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1377971
      },
      "writtenOn": "2023-03-23T17:43:13Z",
      "side": 1,
      "message": "The hope was to put it in this repo to make it easier to integration test against the schema that it\u0027s assuming in Buildbucket. Wdyt?",
      "parentUuid": "7c055fbb_e3557521",
      "revId": "4988d6b849e65fcb24e806e410eefbd13826577d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e1be3d27_326f820d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1002539
      },
      "writtenOn": "2023-03-27T23:06:09Z",
      "side": 1,
      "message": "It can still be a Go codebase using the exact same libraries (and protobuf schemas), using https://pkg.go.dev/go.chromium.org/luci/luciexe/exe. You will *not need* to write Python code.\n\nIt is giant PITA to properly maintain a GAE application and associated cloud resources. You\u0027ll need to setup Terraform automation, deployment automation, a staging instance, etc. \"gae.py upload\" must not be used for production services. Production deployment must happen from trusted build machines.\n\nThis is true for builder luciexe binaries too, but it is easier to setup it up and maintain (especially for a team that maintains a lot of builders, but not a lot of GAE apps).\n\nYou\u0027ll basically just need to add a CIPD manifest for it to https://chromium.googlesource.com/infra/infra/+/refs/heads/main/build/packages/ and refer to it in builder configs using luci.executable e.g. https://chrome-internal.googlesource.com/infra/infra_internal/+/refs/heads/main/infra/config/subprojects/owners_cleanup.star#211\n\n(You\u0027ll likely need a staging builder and a production builder, same as when using GAE. Staging can use \"latest\" version of the package, and the production builder will use a concrete \"git_revision:...\" you\u0027ll update whenever releasing changes).",
      "parentUuid": "27bca13f_d28a300b",
      "revId": "4988d6b849e65fcb24e806e410eefbd13826577d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "231cd123_76e0bad4",
        "filename": "go/src/infra/appengine/builder_health_indicators/app.yaml",
        "patchSetId": 2
      },
      "lineNbr": 6,
      "author": {
        "id": 1002539
      },
      "writtenOn": "2023-03-23T00:03:13Z",
      "side": 1,
      "message": "this can be deleted, by default all requests will be routed to the Go code, which is what we want anyway",
      "range": {
        "startLine": 3,
        "startChar": 0,
        "endLine": 6,
        "endChar": 16
      },
      "revId": "4988d6b849e65fcb24e806e410eefbd13826577d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b00467fb_f878aa43",
        "filename": "go/src/infra/appengine/builder_health_indicators/app.yaml",
        "patchSetId": 2
      },
      "lineNbr": 6,
      "author": {
        "id": 1377971
      },
      "writtenOn": "2023-03-23T17:43:13Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "231cd123_76e0bad4",
      "range": {
        "startLine": 3,
        "startChar": 0,
        "endLine": 6,
        "endChar": 16
      },
      "revId": "4988d6b849e65fcb24e806e410eefbd13826577d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1db8a605_7cce126e",
        "filename": "go/src/infra/appengine/builder_health_indicators/app.yaml",
        "patchSetId": 2
      },
      "lineNbr": 11,
      "author": {
        "id": 1002539
      },
      "writtenOn": "2023-03-23T00:03:13Z",
      "side": 1,
      "message": "I\u0027m not familiar with this. Are you sure it is needed and it works for standard GAE (not GAE Flex)?",
      "range": {
        "startLine": 8,
        "startChar": 0,
        "endLine": 11,
        "endChar": 12
      },
      "revId": "4988d6b849e65fcb24e806e410eefbd13826577d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "599fe234_0eda0fff",
        "filename": "go/src/infra/appengine/builder_health_indicators/app.yaml",
        "patchSetId": 2
      },
      "lineNbr": 11,
      "author": {
        "id": 1377971
      },
      "writtenOn": "2023-03-23T17:43:13Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "1db8a605_7cce126e",
      "range": {
        "startLine": 8,
        "startChar": 0,
        "endLine": 11,
        "endChar": 12
      },
      "revId": "4988d6b849e65fcb24e806e410eefbd13826577d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "115573ea_370e9923",
        "filename": "go/src/infra/appengine/builder_health_indicators/cron.yaml",
        "patchSetId": 2
      },
      "lineNbr": 4,
      "author": {
        "id": 1002539
      },
      "writtenOn": "2023-03-23T00:03:13Z",
      "side": 1,
      "message": "you may want to use e.g. \"every day 00:00\" to control precisely when updates happen. With \"every 24 hours\" the initial time-of-day offset is basically random.",
      "range": {
        "startLine": 4,
        "startChar": 12,
        "endLine": 4,
        "endChar": 26
      },
      "revId": "4988d6b849e65fcb24e806e410eefbd13826577d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b7631b09_64ec649a",
        "filename": "go/src/infra/appengine/builder_health_indicators/cron.yaml",
        "patchSetId": 2
      },
      "lineNbr": 4,
      "author": {
        "id": 1377971
      },
      "writtenOn": "2023-03-23T17:43:13Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "115573ea_370e9923",
      "range": {
        "startLine": 4,
        "startChar": 12,
        "endLine": 4,
        "endChar": 26
      },
      "revId": "4988d6b849e65fcb24e806e410eefbd13826577d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "915bdb20_2387c4c3",
        "filename": "go/src/infra/appengine/builder_health_indicators/deploy.sh",
        "patchSetId": 2
      },
      "lineNbr": 7,
      "author": {
        "id": 1002539
      },
      "writtenOn": "2023-03-23T00:03:13Z",
      "side": 1,
      "message": "If you want to run this service as a real \"production\" one, there are (poorly documented) steps to setup Terraform automation and build \u0026 deploy automation. Production services generally must not be deployed or managed from workstations.",
      "range": {
        "startLine": 7,
        "startChar": 0,
        "endLine": 7,
        "endChar": 13
      },
      "revId": "4988d6b849e65fcb24e806e410eefbd13826577d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9a4f1e4e_184ff6c5",
        "filename": "go/src/infra/appengine/builder_health_indicators/deploy.sh",
        "patchSetId": 2
      },
      "lineNbr": 7,
      "author": {
        "id": 1002539
      },
      "writtenOn": "2023-03-23T00:03:13Z",
      "side": 1,
      "message": "Does this have a staging instance? Once it is running in production, how are you going to verify changes are safe to deploy without e.g. inadvertly marking all builders as red?",
      "range": {
        "startLine": 7,
        "startChar": 23,
        "endLine": 7,
        "endChar": 60
      },
      "revId": "4988d6b849e65fcb24e806e410eefbd13826577d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "840dbfb7_639126cd",
        "filename": "go/src/infra/appengine/builder_health_indicators/deploy.sh",
        "patchSetId": 2
      },
      "lineNbr": 7,
      "author": {
        "id": 1377971
      },
      "writtenOn": "2023-03-23T17:43:13Z",
      "side": 1,
      "message": "That is a good idea. Added one.",
      "parentUuid": "9a4f1e4e_184ff6c5",
      "range": {
        "startLine": 7,
        "startChar": 23,
        "endLine": 7,
        "endChar": 60
      },
      "revId": "4988d6b849e65fcb24e806e410eefbd13826577d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a7537a83_f01b0cd9",
        "filename": "go/src/infra/appengine/builder_health_indicators/deploy.sh",
        "patchSetId": 2
      },
      "lineNbr": 7,
      "author": {
        "id": 1377971
      },
      "writtenOn": "2023-03-23T17:43:13Z",
      "side": 1,
      "message": "I think we want alerting on errors, but not necessarily CI/CD automation just yet. We\u0027re trying for a MVP, and I think the error alerting will give us enough time to fix potential issues, since it\u0027s not the end of the world for the health to be a few days stale, at this stage.",
      "parentUuid": "915bdb20_2387c4c3",
      "range": {
        "startLine": 7,
        "startChar": 0,
        "endLine": 7,
        "endChar": 13
      },
      "revId": "4988d6b849e65fcb24e806e410eefbd13826577d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "45984977_6cfab2ea",
        "filename": "go/src/infra/appengine/builder_health_indicators/main.go",
        "patchSetId": 2
      },
      "lineNbr": 17,
      "author": {
        "id": 1002539
      },
      "writtenOn": "2023-03-23T00:03:13Z",
      "side": 1,
      "message": "note this is needed only if you are planning to use Cloud Datastore",
      "range": {
        "startLine": 17,
        "startChar": 2,
        "endLine": 17,
        "endChar": 36
      },
      "revId": "4988d6b849e65fcb24e806e410eefbd13826577d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c29ef15e_74c73228",
        "filename": "go/src/infra/appengine/builder_health_indicators/main.go",
        "patchSetId": 2
      },
      "lineNbr": 17,
      "author": {
        "id": 1377971
      },
      "writtenOn": "2023-03-23T17:43:13Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "45984977_6cfab2ea",
      "range": {
        "startLine": 17,
        "startChar": 2,
        "endLine": 17,
        "endChar": 36
      },
      "revId": "4988d6b849e65fcb24e806e410eefbd13826577d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "64b194e7_babd0a09",
        "filename": "go/src/infra/appengine/builder_health_indicators/main.go",
        "patchSetId": 2
      },
      "lineNbr": 21,
      "author": {
        "id": 1002539
      },
      "writtenOn": "2023-03-23T00:03:13Z",
      "side": 1,
      "message": "https://pkg.go.dev/go.chromium.org/luci/server/cron#RegisterHandler\n\n```\ncron.RegisterHandler(\"generate\", generate.Generate)\n```\n\nThen change the URL in cron.yaml to /internal/cron/generate (this is where `cron` module exposes handlers).\n\nAmong other things, this will do correct authentication and will produce monitoring metrics.",
      "range": {
        "startLine": 21,
        "startChar": 2,
        "endLine": 21,
        "endChar": 62
      },
      "revId": "4988d6b849e65fcb24e806e410eefbd13826577d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5db7adcc_93e1e26f",
        "filename": "go/src/infra/appengine/builder_health_indicators/main.go",
        "patchSetId": 2
      },
      "lineNbr": 21,
      "author": {
        "id": 1377971
      },
      "writtenOn": "2023-03-23T17:43:13Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "64b194e7_babd0a09",
      "range": {
        "startLine": 21,
        "startChar": 2,
        "endLine": 21,
        "endChar": 62
      },
      "revId": "4988d6b849e65fcb24e806e410eefbd13826577d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}