{
  "comments": [
    {
      "key": {
        "uuid": "86c39e56_f4fb4e3e",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 15,
      "author": {
        "id": 1159599
      },
      "writtenOn": "2020-06-29T17:33:01Z",
      "side": 1,
      "message": "One small high level nit: We should file a Monorail bug to track the Redis migration. :) (And have it block a larger bug for Python 2 -\u003e3 if one exists)",
      "revId": "b60cf66c45688ea6e6f2eecdfb19f64083fdc9c3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "357c548d_a64f05d5",
        "filename": "appengine/monorail/app.yaml.m4",
        "patchSetId": 2
      },
      "lineNbr": 107,
      "author": {
        "id": 1000093
      },
      "writtenOn": "2020-06-27T00:20:54Z",
      "side": 1,
      "message": "This file doesn\u0027t contain any other site-specific settings and we should keep all of those things in one place. I think that place is `settings.py`. Is it possible to keep this stuff in there? If not, we can think of some other solution.",
      "revId": "b60cf66c45688ea6e6f2eecdfb19f64083fdc9c3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d112687a_7562433e",
        "filename": "appengine/monorail/app.yaml.m4",
        "patchSetId": 2
      },
      "lineNbr": 107,
      "author": {
        "id": 1425234
      },
      "writtenOn": "2020-06-29T17:31:46Z",
      "side": 1,
      "message": "The env_variables can easily be moved to `settings.py`, however, I am unaware of any other methods for adding the VPC network connector to the app. The google app engine docs only provide one method as you can see here: https://cloud.google.com/appengine/docs/standard/python/connecting-vpc",
      "parentUuid": "357c548d_a64f05d5",
      "revId": "b60cf66c45688ea6e6f2eecdfb19f64083fdc9c3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ca02f2f9_90b2d2db",
        "filename": "appengine/monorail/app.yaml.m4",
        "patchSetId": 2
      },
      "lineNbr": 107,
      "author": {
        "id": 1000093
      },
      "writtenOn": "2020-06-29T18:04:11Z",
      "side": 1,
      "message": "Google App Engine is really frustrating in this respect. \"I wish GAE would add the option to set instance env vars via the developer console (like every other PaaS with which I am familiar).\" [1]\n\nFor lack of a better solution, and in the interest of unblocking this work, I\u0027ll agree that we can have site settings in app.yaml. In that case, I\u0027ll backtrack a bit and say that we can keep the REDISHOST and REDISPORT here instead of settings.py if it\u0027s simpler that way.\n\nThis will break external deployments of Monorail. It would be nice if we could warn them somehow, but at the very least we can update any references to \"settings.py\" in the documentation to also include updating this file. We\u0027ll also eventually want to have separate instances for prod, staging, and dev, but looks like this file has macros that can handle those.\n\nFor future tech debt work: in an ideal world we have all the site settings in one place, and also don\u0027t check them into the open source repo.\n\n[1] https://stackoverflow.com/questions/22669528/securely-storing-environment-variables-in-gae-with-app-yaml",
      "parentUuid": "d112687a_7562433e",
      "revId": "b60cf66c45688ea6e6f2eecdfb19f64083fdc9c3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b67a296a_388623e6",
        "filename": "appengine/monorail/app.yaml.m4",
        "patchSetId": 2
      },
      "lineNbr": 107,
      "author": {
        "id": 1159599
      },
      "writtenOn": "2020-06-29T18:18:01Z",
      "side": 1,
      "message": "Re: \"This will break external deployments of Monorail. It would be nice if we could warn them somehow\" - We could potentially reach external users of Monorail by sending a PSA to infra-announce@chromium.org. \n\nThis could be an opportunity to start an external monorail-users@chroium.org mailing list or similar that we could encourage external deployments of Monorail to subscribe to. Filed an issue on this to track further discussion here, so as to not derail this code review: https://crbug.com/monorail/7950\n\nFor Rob: This is also a place where publishing externally available docs on how to set up Redis on App Engine for use with Monorail would be helpful, so our external users deploying Monorail can follow those docs themselves to update their own Monorail instances.",
      "parentUuid": "ca02f2f9_90b2d2db",
      "revId": "b60cf66c45688ea6e6f2eecdfb19f64083fdc9c3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e51445ba_1bbdd494",
        "filename": "appengine/monorail/app.yaml.m4",
        "patchSetId": 2
      },
      "lineNbr": 107,
      "author": {
        "id": 1425234
      },
      "writtenOn": "2020-06-29T18:35:36Z",
      "side": 1,
      "message": "Re: \"This will break external deployments of Monorail\" Why will this happen? As in external Monorail users will have to update the env_variables to have a matching IP address + port as the instance they are using?  \n\nI did add the env_variables to settings.py without any issue. As you mentioned, the Redis host IP address will have to change based on staging, but there are examples within the file that can handle that. I am not sure the severity of providing all of the information to connect to the Redis instance on an open-source repo. I will retrace my work to see if someone can connect with just the information that is available and without permissions. I need to read more about VPC networks as well, but from my understanding, both receiver and transmitter must be on the same network to communicate. \n\nRe: \"For Rob:\" I am starting on installing Redis locally now. I can also do a write-up for setting up Redis on App Engine for Monorail users!",
      "parentUuid": "b67a296a_388623e6",
      "revId": "b60cf66c45688ea6e6f2eecdfb19f64083fdc9c3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d19f41a2_55740dcb",
        "filename": "appengine/monorail/app.yaml.m4",
        "patchSetId": 2
      },
      "lineNbr": 107,
      "author": {
        "id": 1000093
      },
      "writtenOn": "2020-06-29T18:44:49Z",
      "side": 1,
      "message": "Not this change specifically, but if Monorail depends on Redis, all the external deployers will have to set up and configure their own Redis instances for Monorail to continue working.",
      "parentUuid": "e51445ba_1bbdd494",
      "revId": "b60cf66c45688ea6e6f2eecdfb19f64083fdc9c3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9b7da16f_16d70fba",
        "filename": "appengine/monorail/app.yaml.m4",
        "patchSetId": 2
      },
      "lineNbr": 107,
      "author": {
        "id": 1425234
      },
      "writtenOn": "2020-06-29T18:49:56Z",
      "side": 1,
      "message": "Understood, thanks for the clarification!",
      "parentUuid": "d19f41a2_55740dcb",
      "revId": "b60cf66c45688ea6e6f2eecdfb19f64083fdc9c3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "695b5c4b_221abeb2",
        "filename": "appengine/monorail/third_party/redis/README.monorail",
        "patchSetId": 2
      },
      "lineNbr": 10,
      "author": {
        "id": 1159599
      },
      "writtenOn": "2020-06-26T20:37:02Z",
      "side": 1,
      "message": "Nit: Remove trailing whitespace?",
      "revId": "b60cf66c45688ea6e6f2eecdfb19f64083fdc9c3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}