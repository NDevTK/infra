# Defines buckets on cr-buildbucket.appspot.com, used by to schedule builds
# on buildbot.
#
# See https://luci-config.appspot.com/schemas/projects:buildbucket.cfg for
# schema of this file and documentation.
#
# Please keep this list sorted by bucket name.

acl_sets {
  name: "try"
  acls {
    role: SCHEDULER
    group: "project-infra-tryjob-access"
  }
  acls {
    role: SCHEDULER
    group: "service-account-cq"
  }
  acls {
    # Allow luci-migration to bump next build number.
    role: WRITER
    identity: "luci-migration@appspot.gserviceaccount.com"
  }
}

acl_sets {
  name: "ci"
  acls {
    role: SCHEDULER
    identity: "luci-scheduler@appspot.gserviceaccount.com"
  }
  acls {
    # Allow luci-migration to bump next build number.
    role: WRITER
    identity: "luci-migration@appspot.gserviceaccount.com"
  }
}

builder_mixins {
  name: "infra recipe"
  recipe {
    cipd_package: "infra/recipe_bundles/chromium.googlesource.com/infra/infra"
    cipd_version: "refs/heads/master"
  }
}

builder_mixins {
  name: "build recipe"
  recipe {
    cipd_package: "infra/recipe_bundles/chromium.googlesource.com/chromium/tools/build"
    cipd_version: "refs/heads/master"
  }
}

builder_mixins {
  name: "depot_tools recipe"
  recipe {
    cipd_package: "infra/recipe_bundles/chromium.googlesource.com/chromium/tools/depot_tools"
    cipd_version: "refs/heads/master"
  }
}

builder_mixins {
  name: "default"
  mixins: "infra recipe"

  dimensions: "cpu:x86-64"

  execution_timeout_secs: 1800  # 30 min
  swarming_tags: "vpython:native-python-wrapper"
}

builder_mixins {
  name: "cache_infra_gclient_with_go"
  caches {
    path: "infra_gclient_with_go"
    name: "infra_gclient_with_go"
  }
}

builder_mixins {
  name: "infra ci"
  mixins: "cache_infra_gclient_with_go"
  recipe {
    name: "infra_continuous"
  }
}

builder_mixins {
  name: "codesearch-gen"
  mixins: "build recipe"
  recipe {
    name: "chromium_codesearch"
  }
  caches {
    path: "generated"
    name: "codesearch_git_genfiles_repo"
  }
}

builder_mixins {
  name: "codesearch-initiator"
  mixins: "build recipe"
  recipe {
    name: "chromium_codesearch_initiator"
  }
}

builder_mixins {
  name: "codesearch-sync-submodules"
  mixins: "infra recipe"
  recipe {
    name: "sync_submodules"
  }
}

builder_mixins {
  name: "codesearch-update-submodules-mirror"
  mixins: "infra recipe"
  recipe {
    name: "update_submodules_mirror"
  }
  caches {
    path: "codesearch_update_submodules_mirror"
    name: "codesearch_update_submodules_mirror"
  }
}

builder_mixins {
  name: "codesearch-gsubmodd"
  mixins: "infra recipe"
  recipe {
    name: "gsubmodd"
  }
}

builder_mixins {
  name: "infra try"
  mixins: "cache_infra_gclient_with_go"
  recipe {
    name: "infra_repo_trybot"
  }
}

builder_mixins {
  # Shared by luci-go Try and CI jobs because recipe is the same.
  name: "luci-go"
  mixins: "cache_infra_gclient_with_go"
  recipe {
    name: "luci_go"
  }
}

builder_mixins {
  # Shared by luci-gae Try and CI jobs because recipe is the same.
  name: "luci-gae"
  mixins: "cache_infra_gclient_with_go"
  recipe {
    name: "luci_gae"
  }
}

builder_mixins {
  name: "recipe_simulation"
  mixins: "default"
  dimensions: "os:Ubuntu-14.04"
  recipe {
    name: "recipe_simulation"
  }
}

builder_mixins {
  name: "recipe_roll_tryjob"
  mixins: "default"
  dimensions: "os:Ubuntu-14.04"
  recipe {
    name: "recipe_roll_tryjob"
  }
}

builder_mixins {
  # Shared by OSX builders that use depot_tools/osx_sdk module.
  name: "uses osx_sdk"
  caches {
    # Cache for mac_toolchain tool and XCode.app
    path: "osx_sdk"
    name: "osx_sdk"
  }
}

buckets {
  name: "ci"
  acl_sets: "public"
  acl_sets: "ci"

  swarming {
    hostname: "chromium-swarm.appspot.com"

    builder_defaults {
      mixins: "default"

      # https://chromium-swarm.appspot.com/botlist?c=id&c=os&c=task&c=status&f=pool%3Aluci.flex.ci
      dimensions: "pool:luci.flex.ci"

      build_numbers: YES

      service_account: "infra-ci-builder@chops-service-accounts.iam.gserviceaccount.com"
    }

    ##########################################################################
    ### infra/infra.git builders

    ###### Variety of Ubuntu versions.
    builders {
      name: "infra-continuous-zesty-64"
      mixins: "infra ci"
      dimensions: "os:Ubuntu-17.04"
      dimensions: "cpu:x86-64"
    }
    builders {
      name: "infra-continuous-yakkety-64"
      mixins: "infra ci"
      dimensions: "os:Ubuntu-16.10"
      dimensions: "cpu:x86-64"
    }
    builders {
      name: "infra-continuous-xenial-64"
      mixins: "infra ci"
      dimensions: "os:Ubuntu-16.04"
      dimensions: "cpu:x86-64"
    }
    builders {
      name: "infra-continuous-trusty-64"
      mixins: "infra ci"
      dimensions: "os:Ubuntu-14.04"
      dimensions: "cpu:x86-64"
    }
    builders {
      name: "infra-continuous-precise-64"
      mixins: "infra ci"
      dimensions: "os:Ubuntu-12.04"
      dimensions: "cpu:x86-64"
    }

    ###### Variety of Mac versions.
    builders {
      name: "infra-continuous-mac-10.13-64"
      mixins: "infra ci"
      mixins: "uses osx_sdk"
      dimensions: "os:Mac-10.13"
      dimensions: "cpu:x86-64"
    }
    builders {
      name: "infra-continuous-mac-10.12-64"
      mixins: "infra ci"
      mixins: "uses osx_sdk"
      dimensions: "os:Mac-10.12"
      dimensions: "cpu:x86-64"
    }
    builders {
      name: "infra-continuous-mac-10.11-64"
      mixins: "infra ci"
      mixins: "uses osx_sdk"
      dimensions: "os:Mac-10.11"
      dimensions: "cpu:x86-64"
    }
    builders {
      name: "infra-continuous-mac-10.10-64"
      mixins: "infra ci"
      mixins: "uses osx_sdk"
      dimensions: "os:Mac-10.10"
      dimensions: "cpu:x86-64"
    }
    builders {
      name: "infra-continuous-mac-10.9-64"
      mixins: "infra ci"
      mixins: "uses osx_sdk"
      dimensions: "os:Mac-10.9"
      dimensions: "cpu:x86-64"
    }

    ###### Some Win versions.
    builders {
      name: "infra-continuous-win7-64"
      mixins: "infra ci"
      dimensions: "os:Windows"
      dimensions: "cpu:x86-64"
    }
    builders {
      name: "infra-continuous-win7-32"
      mixins: "infra ci"
      dimensions: "os:Windows"
      dimensions: "cpu:x86-32"
    }

    builders {
      name: "infra-continuous-win10-64"
      mixins: "infra ci"
      dimensions: "os:Windows-10"
      dimensions: "cpu:x86-64"
    }

    ###### Misc.

    builders {
      name: "infra-continuous-recipes-tests"
      mixins: "recipe_simulation"
      recipe: {
        properties: "project_under_test:infra"
      }
    }


    ##########################################################################
    ### luci-go builders

    ###### Some Ubuntu versions.
    builders {
      name: "luci-go-continuous-xenial-64"
      mixins: "luci-go"
      dimensions: "os:Ubuntu-16.04"
      dimensions: "cpu:x86-64"
    }
    builders {
      name: "luci-go-continuous-trusty-64"
      mixins: "luci-go"
      dimensions: "os:Ubuntu-14.04"
      dimensions: "cpu:x86-64"
    }

    ###### Oldest/Newest Mac only.
    builders {
      name: "luci-go-continuous-mac-10.13-64"
      mixins: "luci-go"
      mixins: "uses osx_sdk"
      dimensions: "os:Mac-10.13"
      dimensions: "cpu:x86-64"
    }
    builders {
      name: "luci-go-continuous-mac-10.9-64"
      mixins: "luci-go"
      mixins: "uses osx_sdk"
      dimensions: "os:Mac-10.9"
      dimensions: "cpu:x86-64"
    }

    ###### Oldest/Newest Win versions.
    builders {
      name: "luci-go-continuous-win7-64"
      mixins: "luci-go"
      dimensions: "os:Windows"
      dimensions: "cpu:x86-64"
    }

    builders {
      name: "luci-go-continuous-win10-64"
      mixins: "luci-go"
      dimensions: "os:Windows-10"
      dimensions: "cpu:x86-64"
    }


    ##########################################################################
    ### luci-gae builders

    builders {
      name: "luci-gae-continuous-trusty-64"
      mixins: "luci-gae"
      dimensions: "os:Ubuntu-14.04"
      dimensions: "cpu:x86-64"
    }

    builders {
      name: "luci-gae-continuous-mac"
      mixins: "luci-gae"
      mixins: "uses osx_sdk"
      dimensions: "os:Mac-10.13"
      dimensions: "cpu:x86-64"
    }

    builders {
      name: "luci-gae-continuous-win"
      mixins: "luci-gae"
      dimensions: "os:Windows-10"
      dimensions: "cpu:x86-64"
    }

    ##########################################################################
    ### recipe-engine builders

    builders {
      name: "recipe_engine-recipes-tests"
      mixins: "recipe_simulation"
      recipe: {
        properties: "project_under_test:recipe_engine"
      }
    }

    ##########################################################################
    ### depot_tools builders

    builders {
      name: "depot_tools-recipes-tests"
      mixins: "recipe_simulation"
      recipe: {
        properties: "project_under_test:depot_tools"
      }
    }

    builders {
      name: "depot_tools zip uploader"
      mixins: "infra recipe"

      service_account: "infra-ci-depot-tools-uploader@chops-service-accounts.iam.gserviceaccount.com"

      recipe: {
        name: "depot_tools_builder"
      }
    }

    ##########################################################################
    ### build (repo) builders

    builders {
      name: "build-recipes-tests"
      mixins: "recipe_simulation"
      recipe: {
        properties: "project_under_test:build"
      }
    }
  }
}

buckets {
  name: "codesearch"
  acl_sets: "public"
  acl_sets: "ci"

  swarming {
    hostname: "chromium-swarm.appspot.com"

    builder_defaults {
      mixins: "default"
      auto_builder_dimension: YES
      dimensions: "pool:luci.infra.codesearch"
      build_numbers: YES
      service_account: "infra-codesearch@chops-service-accounts.iam.gserviceaccount.com"
      recipe {
        # Add mastername property so that the gen recipes can find the right
        # config in mb_config.pyl.
        properties: "mastername:chromium.infra.codesearch"
      }
    }

    builders {
      name: "codesearch-gen-chromium-initiator"
      dimensions: "os:Ubuntu-14.04"
      mixins: "codesearch-initiator"
    }
    builders {
      name: "codesearch-gen-chromium-android"
      dimensions: "os:Ubuntu-14.04"
      mixins: "codesearch-gen"
      execution_timeout_secs: 10800 # 3 hours
    }
    builders {
      name: "codesearch-gen-chromium-chromiumos"
      dimensions: "os:Ubuntu-14.04"
      mixins: "codesearch-gen"
      execution_timeout_secs: 10800 # 3 hours
    }
    builders {
      name: "codesearch-gen-chromium-linux"
      dimensions: "os:Ubuntu-14.04"
      mixins: "codesearch-gen"
      execution_timeout_secs: 7200 # 2 hours
    }
    builders {
      name: "codesearch-gen-chromium-win"
      dimensions: "os:Windows-10"
      mixins: "codesearch-gen"
      execution_timeout_secs: 14400 # 4 hours
    }
    builders {
      name: "codesearch-submodules-build"
      dimensions: "os:Ubuntu-14.04"
      mixins: "codesearch-sync-submodules"
      recipe {
        properties: "source_repo:https://chromium.googlesource.com/chromium/tools/build"
      }
    }
    builders {
      name: "codesearch-submodules-chromium"
      dimensions: "os:Ubuntu-14.04"
      mixins: "codesearch-sync-submodules"
      recipe {
        properties: "source_repo:https://chromium.googlesource.com/chromium/src"
        properties: "extra_submodules:src/out=https://chromium.googlesource.com/chromium/src/out"
      }
    }
    builders {
      name: "codesearch-submodules-infra"
      dimensions: "os:Ubuntu-14.04"
      mixins: "codesearch-sync-submodules"
      recipe {
        properties: "source_repo:https://chromium.googlesource.com/infra/infra"
      }
    }
    builders {
      name: "codesearch-update-submodules-mirror-src"
      dimensions: "os:Ubuntu-14.04"
      mixins: "codesearch-update-submodules-mirror"
      execution_timeout_secs: 3600 # 1 hour
      recipe {
        properties: "source_repo:https://chromium.googlesource.com/chromium/src"
        properties: "target_repo:https://chromium.googlesource.com/experimental/codesearch/grimoire/chromium/src"
      }
    }
    builders {
      name: "gsubmodd-src"
      dimensions: "os:Ubuntu-14.04"
      mixins: "codesearch-gsubmodd"
      execution_timeout_secs: 14400 # 4 hours
      recipe {
        properties: "source_repo:https://chromium.googlesource.com/chromium/src"
        # Without caching, it takes nearly an hour just to set up the initial
        # clone, before we even start processing it.  Recent experience suggests
        # that we can get through 500 commits in around 15 minutes; so perhaps
        # it's safe enough to try going for 5000 in the remaining 3 hours.
        properties: "limit:5000"
        properties: "target_repo:https://chromium.googlesource.com/experimental/codesearch/chromium/src"
      }
    }
    builders {
      name: "gsubmodd-infra"
      dimensions: "os:Ubuntu-14.04"
      mixins: "codesearch-gsubmodd"
      execution_timeout_secs: 14400 # 4 hours
      recipe {
        properties: "source_repo:https://chromium.googlesource.com/infra/infra"
        # Impose a modest per-invocation limit on number of commits processed,
        # during initial bootstrap, until we catch up to present time.
        properties: "limit:1000"
        properties: "target_repo:https://chromium.googlesource.com/experimental/codesearch/infra/infra"
      }
    }
  }
}

# Section for luci.infra.cron

builder_mixins {
  name: "gsubtreed-shared-machines"
  mixins: "infra recipe"
  auto_builder_dimension: NO  # Share machines with other gsubtreed- builders.
  dimensions: "builder:gsubtreed-shared"
  dimensions: "os:Ubuntu-14.04"
  recipe {
    name: "gsubtreed"
    # Don't loop, run just once. For lesser used gsubtreeds, rate of commit is
    # low. This also allows for more efficient machine sharing.
    properties_j: "cycle_time_sec:1"
  }
  # 1 stuck builder shouldn't block others using the same pool of machines.
  execution_timeout_secs: 600  # 10 minutes.
}

buckets {
  name: "cron"
  acl_sets: "public"
  acl_sets: "ci"

  swarming {
    hostname: "chromium-swarm.appspot.com"

    builder_defaults {
      mixins: "default"

      # There is no default task service account. Majority of builders here have
      # side-effect, so they must use their own service account. To create
      # one, either:
      #  * file Infra>Platform>Admin ticket
      #  * (Googlers only) follow http://go/luci-new-task-account doc.

      auto_builder_dimension: YES
      # https://chromium-swarm.appspot.com/botlist?c=id&c=os&c=task&c=status&f=pool%3Aluci.infra.cron
      dimensions: "pool:luci.infra.cron"

      execution_timeout_secs: 3600 # 1 hour

      luci_migration_host: "luci-migration.appspot.com"

      recipe {
        name: "fake-recipe"
      }
    }
    builders {
      name: "gsubtreed-aosp-platform-system-core"
      mixins: "gsubtreed-shared-machines"
      service_account: "gsubtreed-aosp@chops-service-accounts.iam.gserviceaccount.com"
      recipe {
        properties: "target_repo:https://chromium.googlesource.com/aosp/platform/system/core"
      }
    }
    builders {
      name: "gsubtreed-llvm-clang"
      mixins: "gsubtreed-shared-machines"
      recipe {
        properties: "target_repo:https://chromium.googlesource.com/external/github.com/llvm-mirror/clang"
      }
      service_account: "gsubtreed-llvm-clang@chops-service-accounts.iam.gserviceaccount.com"
    }
    builders {
      name: "gsubtreed-chromium"
      mixins: "gsubtreed-shared-machines"
      recipe {
        properties: "target_repo:https://chromium.googlesource.com/chromium/src"
      }
      service_account: "gsubtreed-chromium-src@chops-service-accounts.iam.gserviceaccount.com"
      # Re-bootstrapping chromium repo takes 1+ hours.
      execution_timeout_secs: 10800  # 3 hours.
    }
    builders {
      name: "gsubtreed-chromiumos-platform2"
      mixins: "gsubtreed-shared-machines"
      recipe {
        properties: "target_repo:https://chromium.googlesource.com/chromiumos/platform2"
      }
      service_account: "gsubtreed-chromiumos-platform2@chops-service-accounts.iam.gserviceaccount.com"
    }
    builders {
      name: "gsubtreed-infra"
      mixins: "gsubtreed-shared-machines"
      recipe {
        properties: "target_repo:https://chromium.googlesource.com/infra/infra"
      }
      service_account: "gsubtreed-infra-infra@chops-service-accounts.iam.gserviceaccount.com"
    }
    builders {
      name: "gsubtreed-luci-py"
      mixins: "gsubtreed-shared-machines"
      recipe {
        properties: "target_repo:https://chromium.googlesource.com/infra/luci/luci-py"
      }
      service_account: "gsubtreed-luci-py@chops-service-accounts.iam.gserviceaccount.com"
    }
    builders {
      name: "chromium-lkgr-finder"
      service_account: "chromium-lkgr-finder-builder@chops-service-accounts.iam.gserviceaccount.com"
      dimensions: "os:Ubuntu-14.04"
      recipe { name: "lkgr_finder" }
    }
    builders {
      name: "Build From Tarball"
      dimensions: "os:Ubuntu-14.04"
      service_account: "chromium-tarball-builder@chops-service-accounts.iam.gserviceaccount.com"
      recipe { name: "build_from_tarball" }
      execution_timeout_secs: 10800  # 3 hours.
    }
    builders {
      name: "publish_tarball"
      service_account: "chromium-tarball-builder@chops-service-accounts.iam.gserviceaccount.com"
      dimensions: "os:Ubuntu-14.04"
      recipe { name: "publish_tarball" }
      execution_timeout_secs: 10800  # 3 hours.
    }
    builders {
      name: "wpt-exporter"
      service_account: "wpt-autoroller@chops-service-accounts.iam.gserviceaccount.com"
      dimensions: "os:Ubuntu-14.04"
      recipe {
        name: "wpt_export"
        # TODO(crbug.com/803111): Temporarily added for the migration app. Remove after migration.
        properties: "mastername:chromium.infra.cron"
      }
    }
    builders {
      name: "wpt-importer"
      service_account: "wpt-autoroller@chops-service-accounts.iam.gserviceaccount.com"
      execution_timeout_secs: 18000  # 5 hours
      dimensions: "os:Ubuntu-14.04"
      recipe {
        name: "wpt_import"
        # TODO(crbug.com/803111): Temporarily added for the migration app. Remove after migration.
        properties: "mastername:chromium.infra.cron"
      }
    }
    builders {
      name: "luci-check"
      dimensions: "os:Ubuntu-14.04"
      recipe {
        name: "luci_check"
      }
    }
    builders {
      name: "Chromium Gatekeeper"
      mixins: "build recipe"
      dimensions: "os:Ubuntu-14.04"
      recipe {
        name: "gatekeeper"
      }
    }

    builders {
      name: "Chromium Gatekeeper Failure"
      mixins: "build recipe"
      dimensions: "os:Ubuntu-14.04"
      recipe {
        name: "gatekeeper-failure"
      }
    }
  }
}
# End section for luci.infra.cron

buckets {
  name: "try"
  acl_sets: "public"
  acl_sets: "try"

  swarming {
    hostname: "chromium-swarm.appspot.com"
    task_template_canary_percentage { value: 30 }

    builder_defaults {
      mixins: "default"

      # https://chromium-swarm.appspot.com/botlist?c=id&c=os&c=task&c=status&f=pool%3Aluci.flex.try
      dimensions: "pool:luci.flex.try"

      service_account: "infra-try-builder@chops-service-accounts.iam.gserviceaccount.com"
    }


    # Keep builders sorted by category, then name.

    builders {
      category: "Build"
      name: "Build Presubmit"
      dimensions: "os:Ubuntu-14.04"
      mixins: "build recipe"
      recipe {
        name: "run_presubmit"
        properties: "repo_name:build"
        properties_j: "runhooks:true"
      }
    }

    builders {
      category: "Build"
      name: "Build Recipes Tester"

      dimensions: "os:Ubuntu-14.04"
      mixins: "build recipe"
      execution_timeout_secs: 10800 # 3 hours
      recipe {
        name: "led_recipes_tester"
        properties: "repo_name:build"
      }

      service_account: "infra-try-recipes-tester@chops-service-accounts.iam.gserviceaccount.com"
    }

    builders {
      category: "Depot Tools"
      name: "Depot Tools Presubmit"
      dimensions: "os:Ubuntu-14.04"
      mixins: "build recipe"
      recipe {
        name: "run_presubmit"
        properties: "repo_name:depot_tools"
      }
    }

    builders {
      category: "Depot Tools"
      name: "fetch End-to-End Tester"
      dimensions: "os:Ubuntu-14.04"
      mixins: "depot_tools recipe"
      recipe {
        name: "fetch_end_to_end_test"
      }
      execution_timeout_secs: 21600  # 6 hours
    }

    builders {
      category: "Expect-Tests"
      name: "Expect-Tests Presubmit"
      dimensions: "os:Ubuntu-14.04"
      mixins: "build recipe"
      recipe {
        name: "run_presubmit"
        properties: "repo_name:expect_tests"
      }
    }

    builders {
      category: "Gerrit CQ"
      name: "gerrit-test-cq-normal"
      dimensions: "os:Ubuntu-14.04"
      recipe {
        name: "gerrit_cq_test"
      }
    }

    builders {
      category: "Luci-GAE"
      name: "Luci-GAE Linux Trusty 64 Tester"
      mixins: "luci-gae"
      dimensions: "os:Ubuntu-14.04"
      recipe {
        name: "luci_gae"
      }
    }

    builders {
      category: "Luci-GAE"
      name: "Luci-GAE Presubmit"
      mixins: "luci-gae"
      dimensions: "os:Ubuntu-14.04"
      recipe {
        name: "luci_gae"
      }
    }

    builders {
      category: "Luci-go"
      name: "Luci-go Linux Trusty 64 Tester"
      mixins: "luci-go"
      dimensions: "os:Ubuntu-14.04"
    }

    builders {
      category: "Luci-go"
      name: "Luci-go Mac Tester"
      mixins: "luci-go"
      mixins: "uses osx_sdk"
      dimensions: "os:Mac-10.13"
    }

    builders {
      category: "Luci-go"
      name: "Luci-go Presubmit"
      mixins: "luci-go"
      dimensions: "os:Ubuntu-14.04"
      recipe {
        properties_j: "presubmit:true"
      }
    }

    builders {
      category: "Luci-go"
      name: "Luci-go Win Tester"
      mixins: "luci-go"
      dimensions: "os:Windows"
    }

    builders {
      category: "Luci-py"
      name: "Luci-py Presubmit"
      dimensions: "os:Ubuntu-14.04"
      mixins: "build recipe"
      recipe {
        name: "run_presubmit"
        properties: "repo_name:luci_py"
        properties_j: "runhooks:true"
      }
    }

    builders {
      category: "Infra"
      name: "Infra Linux Trusty 64 Tester"
      dimensions: "os:Ubuntu-14.04"
      mixins: "infra try"
    }
    builders {
      category: "Infra"
      name: "Infra Mac Tester"
      dimensions: "os:Mac-10.13"
      mixins: "infra try"
      mixins: "uses osx_sdk"
    }
    builders {
      category: "Infra"
      name: "Infra Presubmit"
      dimensions: "os:Ubuntu-14.04"
      mixins: "build recipe"
      recipe {
        name: "run_presubmit"
        properties: "repo_name:infra"
        properties_j: "runhooks:true"
      }
    }
    builders {
      category: "Infra"
      name: "Infra Win Tester"
      dimensions: "os:Windows"
      mixins: "infra try"
    }
    builders {
      category: "Infra"
      name: "Infra WCT Tester"
      dimensions: "os:Ubuntu-14.04"
      mixins: "infra try"
      recipe {
        name: "infra_wct_tester"
      }
    }

    builders {
      category: "Recipes-py"
      name: "Recipes-py Presubmit"
      dimensions: "os:Ubuntu-14.04"
      mixins: "build recipe"
      recipe {
        name: "run_presubmit"
        properties: "repo_name:recipes_py"
        properties_j: "runhooks:true"
      }
    }

    ###########################################################################
    # Downstream recipe roller testers.

    builders {
      # TODO(tandrii): this builder seems to be unused.
      name: "Recipe Roll Downstream Tester"
      mixins: "recipe_roll_tryjob"
      dimensions: "os:Ubuntu-14.04"
    }

    # Recipe rolls from Recipe Engine.

    builders {
      name: "Depot Tools downstream Recipe Roll tester from Recipe Engine"
      mixins: "recipe_roll_tryjob"
      recipe {
        properties: "upstream_project:recipe_engine"
        properties: "downstream_project:depot_tools"
      }
    }

    builders {
      name: "Build downstream Recipe Roll tester from Recipe Engine"
      mixins: "recipe_roll_tryjob"
      recipe {
        properties: "upstream_project:recipe_engine"
        properties: "downstream_project:build"
      }
    }

    builders {
      name: "Infra downstream Recipe Roll tester from Recipe Engine"
      mixins: "recipe_roll_tryjob"
      recipe {
        properties: "upstream_project:recipe_engine"
        properties: "downstream_project:infra"
      }
    }

    builders {
      name: "Skia downstream Recipe Roll tester from Recipe Engine"
      mixins: "recipe_roll_tryjob"
      recipe {
        properties: "upstream_project:recipe_engine"
        properties: "downstream_project:skia"
      }
    }

    builders {
      name: "Skia Buildbot downstream Recipe Roll tester from Recipe Engine"
      mixins: "recipe_roll_tryjob"
      recipe {
        properties: "upstream_project:recipe_engine"
        properties: "downstream_project:skiabuildbot"
      }
    }

    # Recipe rolls from Build.

    builders {
      name: "Infra downstream Recipe Roll tester from Build"
      mixins: "recipe_roll_tryjob"
      recipe {
        properties: "upstream_project:build"
        properties: "downstream_project:infra"
      }
    }

    # Recipe rolls from Depot Tools.

    builders {
      name: "Build downstream Recipe Roll tester from Depot Tools"
      mixins: "recipe_roll_tryjob"
      recipe {
        properties: "upstream_project:depot_tools"
        properties: "downstream_project:build"
      }
    }

    builders {
      name: "Infra downstream Recipe Roll tester from Depot Tools"
      mixins: "recipe_roll_tryjob"
      recipe {
        properties: "upstream_project:depot_tools"
        properties: "downstream_project:infra"
      }
    }

    builders {
      name: "Skia downstream Recipe Roll tester from Depot Tools"
      mixins: "recipe_roll_tryjob"
      recipe {
        properties: "upstream_project:depot_tools"
        properties: "downstream_project:skia"
      }
    }

    builders {
      name: "Skia Buildbot downstream Recipe Roll tester from Depot Tools"
      mixins: "recipe_roll_tryjob"
      recipe {
        properties: "upstream_project:depot_tools"
        properties: "downstream_project:skiabuildbot"
      }
    }
  }
}

# TODO(tandrii): delete these completely.

acl_sets {
  name: "public"
  acls {
    role: READER
    group: "all"
  }
}


buckets {
  name: "master.chromium.infra.cron"
  acl_sets: "public"
  acls {
    role: WRITER
    group: "service-account-infra-master-cron"
  }
}
