{
  "comments": [
    {
      "key": {
        "uuid": "50cc0ab0_0d4f9017",
        "filename": "appengine/findit/services/test_failure/ci_test_failure.py",
        "patchSetId": 2
      },
      "lineNbr": 96,
      "author": {
        "id": 1164104
      },
      "writtenOn": "2018-08-23T23:24:43Z",
      "side": 1,
      "message": "What does this method return? Is it the log with string type or some dictionary after parsing the logs?",
      "range": {
        "startLine": 96,
        "startChar": 5,
        "endLine": 96,
        "endChar": 28
      },
      "revId": "f4cd8444f004dcfeed15df56720487f7bfd35fd0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4e212d7e_816a2950",
        "filename": "appengine/findit/services/test_failure/ci_test_failure.py",
        "patchSetId": 2
      },
      "lineNbr": 96,
      "author": {
        "id": 1157909
      },
      "writtenOn": "2018-08-24T21:08:13Z",
      "side": 1,
      "message": "Added docstring",
      "parentUuid": "50cc0ab0_0d4f9017",
      "range": {
        "startLine": 96,
        "startChar": 5,
        "endLine": 96,
        "endChar": 28
      },
      "revId": "f4cd8444f004dcfeed15df56720487f7bfd35fd0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "32561c0d_d41ced61",
        "filename": "appengine/findit/services/test_failure/ci_test_failure.py",
        "patchSetId": 2
      },
      "lineNbr": 324,
      "author": {
        "id": 1164104
      },
      "writtenOn": "2018-08-23T23:24:43Z",
      "side": 1,
      "message": "Please also add a Returns. What gets returned seems to be a non-trivial map.",
      "range": {
        "startLine": 324,
        "startChar": 1,
        "endLine": 324,
        "endChar": 5
      },
      "revId": "f4cd8444f004dcfeed15df56720487f7bfd35fd0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c469ea06_b25277b5",
        "filename": "appengine/findit/services/test_failure/ci_test_failure.py",
        "patchSetId": 2
      },
      "lineNbr": 324,
      "author": {
        "id": 1157909
      },
      "writtenOn": "2018-08-24T21:08:13Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "32561c0d_d41ced61",
      "range": {
        "startLine": 324,
        "startChar": 1,
        "endLine": 324,
        "endChar": 5
      },
      "revId": "f4cd8444f004dcfeed15df56720487f7bfd35fd0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "aede6aca_a869b3e1",
        "filename": "appengine/findit/services/test_failure/ci_test_failure.py",
        "patchSetId": 2
      },
      "lineNbr": 327,
      "author": {
        "id": 1164104
      },
      "writtenOn": "2018-08-23T23:24:43Z",
      "side": 1,
      "message": "Where is this defined? I couldn\u0027t find it.\nhttps://cs.chromium.org/chromium/infra/appengine/findit/services/ci_failure.py?q\u003dci_failure.py\u0026sq\u003dpackage:chromium\u0026g\u003d0\u0026l\u003d1",
      "range": {
        "startLine": 327,
        "startChar": 17,
        "endLine": 327,
        "endChar": 53
      },
      "revId": "f4cd8444f004dcfeed15df56720487f7bfd35fd0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "688624a9_69242cf3",
        "filename": "appengine/findit/services/test_failure/ci_test_failure.py",
        "patchSetId": 2
      },
      "lineNbr": 327,
      "author": {
        "id": 1157909
      },
      "writtenOn": "2018-08-24T21:08:13Z",
      "side": 1,
      "message": "This CL is depending on the other 2 CLs, and the function is added in https://chromium-review.googlesource.com/c/infra/infra/+/1154430/6",
      "parentUuid": "aede6aca_a869b3e1",
      "range": {
        "startLine": 327,
        "startChar": 17,
        "endLine": 327,
        "endChar": 53
      },
      "revId": "f4cd8444f004dcfeed15df56720487f7bfd35fd0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "325f341c_2a02dec6",
        "filename": "appengine/findit/services/test_failure/ci_test_failure.py",
        "patchSetId": 2
      },
      "lineNbr": 327,
      "author": {
        "id": 1164104
      },
      "writtenOn": "2018-08-24T21:18:12Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "688624a9_69242cf3",
      "range": {
        "startLine": 327,
        "startChar": 17,
        "endLine": 327,
        "endChar": 53
      },
      "revId": "f4cd8444f004dcfeed15df56720487f7bfd35fd0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c343476a_5562bb94",
        "filename": "appengine/findit/services/test_failure/ci_test_failure.py",
        "patchSetId": 2
      },
      "lineNbr": 334,
      "author": {
        "id": 1164104
      },
      "writtenOn": "2018-08-23T23:24:43Z",
      "side": 1,
      "message": "I haven\u0027t been able to fully understand the algorithm yet, but I think this name is very confusing. The name indicates that it stores a list of succeeded tests or something a like, however, after reading the code, it seems that it\u0027s actually a map from steps to a set of \"failed\" tests.\n\nIf I understood correctly, it\u0027s better to be renamed.",
      "range": {
        "startLine": 334,
        "startChar": 2,
        "endLine": 334,
        "endChar": 15
      },
      "revId": "f4cd8444f004dcfeed15df56720487f7bfd35fd0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9ffba674_77ffacc0",
        "filename": "appengine/findit/services/test_failure/ci_test_failure.py",
        "patchSetId": 2
      },
      "lineNbr": 334,
      "author": {
        "id": 1157909
      },
      "writtenOn": "2018-08-24T21:08:13Z",
      "side": 1,
      "message": "It really is succeeded tests to me. Could you tell me which part of the code makes you think it\u0027s for failed tests?",
      "parentUuid": "c343476a_5562bb94",
      "range": {
        "startLine": 334,
        "startChar": 2,
        "endLine": 334,
        "endChar": 15
      },
      "revId": "f4cd8444f004dcfeed15df56720487f7bfd35fd0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2652964b_870541d8",
        "filename": "appengine/findit/services/test_failure/ci_test_failure.py",
        "patchSetId": 2
      },
      "lineNbr": 334,
      "author": {
        "id": 1164104
      },
      "writtenOn": "2018-08-24T21:18:12Z",
      "side": 1,
      "message": "Maybe I\u0027m missing some context, but please see my other two comments.",
      "parentUuid": "9ffba674_77ffacc0",
      "range": {
        "startLine": 334,
        "startChar": 2,
        "endLine": 334,
        "endChar": 15
      },
      "revId": "f4cd8444f004dcfeed15df56720487f7bfd35fd0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "619ded05_fe7f1022",
        "filename": "appengine/findit/services/test_failure/ci_test_failure.py",
        "patchSetId": 2
      },
      "lineNbr": 336,
      "author": {
        "id": 1164104
      },
      "writtenOn": "2018-08-23T23:24:43Z",
      "side": 1,
      "message": "Move http_client closer to where it is used.",
      "range": {
        "startLine": 336,
        "startChar": 2,
        "endLine": 336,
        "endChar": 34
      },
      "revId": "f4cd8444f004dcfeed15df56720487f7bfd35fd0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fe187362_ba9b62f4",
        "filename": "appengine/findit/services/test_failure/ci_test_failure.py",
        "patchSetId": 2
      },
      "lineNbr": 336,
      "author": {
        "id": 1118104
      },
      "writtenOn": "2018-08-24T18:37:42Z",
      "side": 1,
      "message": "I think the point of having it here is to avoid creating it for every iteration of the loops inside. I\u0027d say we either go with the suggestion below (just inline the call to the constructor) or create a global singleton, private to this module `_HTTP_CLIENT \u003d FinditHttpClient()`\n\nI think instantiating the client is lightweight enough that we could do it at every iteration, OTOH, the http client is reusable and should not keep any state, furthermore, expensive behaviors could be later added to the instantiation code (e.g. for more detailed monitoring).\n\nI am okay with either approach, as long as we decide to stick to it going forward.",
      "parentUuid": "619ded05_fe7f1022",
      "range": {
        "startLine": 336,
        "startChar": 2,
        "endLine": 336,
        "endChar": 34
      },
      "revId": "f4cd8444f004dcfeed15df56720487f7bfd35fd0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d9f07395_ecd7bf93",
        "filename": "appengine/findit/services/test_failure/ci_test_failure.py",
        "patchSetId": 2
      },
      "lineNbr": 336,
      "author": {
        "id": 1157909
      },
      "writtenOn": "2018-08-24T21:08:13Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "fe187362_ba9b62f4",
      "range": {
        "startLine": 336,
        "startChar": 2,
        "endLine": 336,
        "endChar": 34
      },
      "revId": "f4cd8444f004dcfeed15df56720487f7bfd35fd0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8ab0c358_98ef6da8",
        "filename": "appengine/findit/services/test_failure/ci_test_failure.py",
        "patchSetId": 2
      },
      "lineNbr": 352,
      "author": {
        "id": 1164104
      },
      "writtenOn": "2018-08-23T23:24:43Z",
      "side": 1,
      "message": "Something to consider for a follow-up CL, I think the failure_to_culprit_map is very hard to follow, if it\u0027s used a lot, it\u0027s better to create a class and encapsulates the map inside it. Something like:\n\nClass FailureToCulpritMap(object):\n  def GetAllSteps(self):\n  def GetAllFailedTestsForAStep(self, step_name):\n  ...",
      "range": {
        "startLine": 352,
        "startChar": 10,
        "endLine": 352,
        "endChar": 64
      },
      "revId": "f4cd8444f004dcfeed15df56720487f7bfd35fd0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "da5ea793_2d4f2c59",
        "filename": "appengine/findit/services/test_failure/ci_test_failure.py",
        "patchSetId": 2
      },
      "lineNbr": 352,
      "author": {
        "id": 1118104
      },
      "writtenOn": "2018-08-24T18:37:42Z",
      "side": 1,
      "message": "That\u0027d be good improvement for readability.",
      "parentUuid": "8ab0c358_98ef6da8",
      "range": {
        "startLine": 352,
        "startChar": 10,
        "endLine": 352,
        "endChar": 64
      },
      "revId": "f4cd8444f004dcfeed15df56720487f7bfd35fd0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0225d07d_5d5f8ee0",
        "filename": "appengine/findit/services/test_failure/ci_test_failure.py",
        "patchSetId": 2
      },
      "lineNbr": 352,
      "author": {
        "id": 1157909
      },
      "writtenOn": "2018-08-24T21:08:13Z",
      "side": 1,
      "message": "Good point. I\u0027ll make the check in the first CL of this chain of CLs.",
      "parentUuid": "da5ea793_2d4f2c59",
      "range": {
        "startLine": 352,
        "startChar": 10,
        "endLine": 352,
        "endChar": 64
      },
      "revId": "f4cd8444f004dcfeed15df56720487f7bfd35fd0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6d618e57_253b7762",
        "filename": "appengine/findit/services/test_failure/ci_test_failure.py",
        "patchSetId": 2
      },
      "lineNbr": 352,
      "author": {
        "id": 1164104
      },
      "writtenOn": "2018-08-24T21:18:12Z",
      "side": 1,
      "message": "I believe failure_to_culprit_map stores a lit of failed tests, so this essentially means:\nsucceed_tests[succeeded_step] \u003d # A set of failed tests in failure_to_culprit_map.",
      "range": {
        "startLine": 351,
        "startChar": 6,
        "endLine": 352,
        "endChar": 64
      },
      "revId": "f4cd8444f004dcfeed15df56720487f7bfd35fd0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3073dae2_21bd22b9",
        "filename": "appengine/findit/services/test_failure/ci_test_failure.py",
        "patchSetId": 2
      },
      "lineNbr": 352,
      "author": {
        "id": 1164104
      },
      "writtenOn": "2018-08-24T21:18:12Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "0225d07d_5d5f8ee0",
      "range": {
        "startLine": 352,
        "startChar": 10,
        "endLine": 352,
        "endChar": 64
      },
      "revId": "f4cd8444f004dcfeed15df56720487f7bfd35fd0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fad4e75d_a25f6c68",
        "filename": "appengine/findit/services/test_failure/ci_test_failure.py",
        "patchSetId": 2
      },
      "lineNbr": 352,
      "author": {
        "id": 1157909
      },
      "writtenOn": "2018-08-24T21:31:34Z",
      "side": 1,
      "message": "failure_to_culprit_map stores all originally failed tests, and in this function, I\u0027m comparing failures in newer builds to failure_to_culprit_map. And here, some steps in failure_to_culprit_map are not failed in in one of the newer build, so all originally failed tests in these steps succeed, so I move them to succeed_tests",
      "parentUuid": "6d618e57_253b7762",
      "range": {
        "startLine": 351,
        "startChar": 6,
        "endLine": 352,
        "endChar": 64
      },
      "revId": "f4cd8444f004dcfeed15df56720487f7bfd35fd0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e7ef2cd1_1f5a93fa",
        "filename": "appengine/findit/services/test_failure/ci_test_failure.py",
        "patchSetId": 2
      },
      "lineNbr": 355,
      "author": {
        "id": 1164104
      },
      "writtenOn": "2018-08-23T23:24:43Z",
      "side": 1,
      "message": "remaining_steps_to_check has removed all the succeeded_steps, so it should be strictly a subset of faild_steps now.",
      "range": {
        "startLine": 355,
        "startChar": 21,
        "endLine": 355,
        "endChar": 60
      },
      "revId": "f4cd8444f004dcfeed15df56720487f7bfd35fd0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "97064915_a0500a75",
        "filename": "appengine/findit/services/test_failure/ci_test_failure.py",
        "patchSetId": 2
      },
      "lineNbr": 355,
      "author": {
        "id": 1157909
      },
      "writtenOn": "2018-08-24T21:08:13Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "e7ef2cd1_1f5a93fa",
      "range": {
        "startLine": 355,
        "startChar": 21,
        "endLine": 355,
        "endChar": 60
      },
      "revId": "f4cd8444f004dcfeed15df56720487f7bfd35fd0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "72551efb_61aa875e",
        "filename": "appengine/findit/services/test_failure/ci_test_failure.py",
        "patchSetId": 2
      },
      "lineNbr": 360,
      "author": {
        "id": 1164104
      },
      "writtenOn": "2018-08-23T23:24:43Z",
      "side": 1,
      "message": "Can we replace this with FindidHttpClient()?",
      "range": {
        "startLine": 360,
        "startChar": 68,
        "endLine": 360,
        "endChar": 79
      },
      "revId": "f4cd8444f004dcfeed15df56720487f7bfd35fd0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9546f1e3_946c3f16",
        "filename": "appengine/findit/services/test_failure/ci_test_failure.py",
        "patchSetId": 2
      },
      "lineNbr": 360,
      "author": {
        "id": 1157909
      },
      "writtenOn": "2018-08-24T21:08:13Z",
      "side": 1,
      "message": "I\u0027d keep it as is because I use this for each build and step and I don\u0027t want to create a new instance every time",
      "parentUuid": "72551efb_61aa875e",
      "range": {
        "startLine": 360,
        "startChar": 68,
        "endLine": 360,
        "endChar": 79
      },
      "revId": "f4cd8444f004dcfeed15df56720487f7bfd35fd0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8ad4511d_df04a87a",
        "filename": "appengine/findit/services/test_failure/ci_test_failure.py",
        "patchSetId": 2
      },
      "lineNbr": 360,
      "author": {
        "id": 1164104
      },
      "writtenOn": "2018-08-24T21:18:12Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "9546f1e3_946c3f16",
      "range": {
        "startLine": 360,
        "startChar": 68,
        "endLine": 360,
        "endChar": 79
      },
      "revId": "f4cd8444f004dcfeed15df56720487f7bfd35fd0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d0545d0e_894c52f9",
        "filename": "appengine/findit/services/test_failure/ci_test_failure.py",
        "patchSetId": 2
      },
      "lineNbr": 364,
      "author": {
        "id": 1164104
      },
      "writtenOn": "2018-08-24T21:18:12Z",
      "side": 1,
      "message": "suceeded_tests[step_name] \u003d # failed tests.",
      "range": {
        "startLine": 364,
        "startChar": 8,
        "endLine": 364,
        "endChar": 58
      },
      "revId": "f4cd8444f004dcfeed15df56720487f7bfd35fd0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a62acab5_76b47883",
        "filename": "appengine/findit/services/test_failure/ci_test_failure.py",
        "patchSetId": 2
      },
      "lineNbr": 364,
      "author": {
        "id": 1157909
      },
      "writtenOn": "2018-08-24T21:31:34Z",
      "side": 1,
      "message": "See comment above. I don\u0027t get the failure log, so I couldn\u0027t know whether the tests in this step pass or fail, or if they run at all. And to be safe, I just assume they pass and move them to succeed_tests",
      "parentUuid": "d0545d0e_894c52f9",
      "range": {
        "startLine": 364,
        "startChar": 8,
        "endLine": 364,
        "endChar": 58
      },
      "revId": "f4cd8444f004dcfeed15df56720487f7bfd35fd0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fd4d6c8d_5cd9b7c5",
        "filename": "appengine/findit/services/test_failure/test_culprit_action.py",
        "patchSetId": 2
      },
      "lineNbr": 130,
      "author": {
        "id": 1164104
      },
      "writtenOn": "2018-08-23T23:24:43Z",
      "side": 1,
      "message": "This can be reduced to two lines:\n    logging.info(\n        \u0027No revert or notification needed for culprit(s) for %s/%s/%s since \u0027\n        \u0027the failure has stopped.\u0027, master_name, builder_name, build_number)",
      "range": {
        "startLine": 128,
        "startChar": 0,
        "endLine": 130,
        "endChar": 21
      },
      "revId": "f4cd8444f004dcfeed15df56720487f7bfd35fd0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c880b6b5_3d3afb47",
        "filename": "appengine/findit/services/test_failure/test_culprit_action.py",
        "patchSetId": 2
      },
      "lineNbr": 130,
      "author": {
        "id": 1157909
      },
      "writtenOn": "2018-08-24T21:08:13Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "fd4d6c8d_5cd9b7c5",
      "range": {
        "startLine": 128,
        "startChar": 0,
        "endLine": 130,
        "endChar": 21
      },
      "revId": "f4cd8444f004dcfeed15df56720487f7bfd35fd0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}